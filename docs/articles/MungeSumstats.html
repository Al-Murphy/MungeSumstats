<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`MungeSumstats`: Getting started • MungeSumstats</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`MungeSumstats`: Getting started">
<meta property="og:description" content="MungeSumstats">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MungeSumstats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/MungeSumstats.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/docker.html">Docker/Singularity Containers</a>
    </li>
    <li>
      <a href="../articles/OpenGWAS.html">Import GWAS summary statistics from Open GWAS</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/neurogenomics/MungeSumstats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<code>MungeSumstats</code>: Getting started</h1>
                        <h4 data-toc-skip class="author"><h5>
<br><i>Authors</i>: Alan Murphy, Brian Schilder and Nathan Skene<br>
</h5></h4>
            
            <h4 data-toc-skip class="date"><h5>
<br><i>Updated</i>: Dec-17-2024<br>
</h5></h4>
      
      <small class="dont-index">Source: <a href="https://github.com/neurogenomics/MungeSumstats/blob/HEAD/vignettes/MungeSumstats.Rmd" class="external-link"><code>vignettes/MungeSumstats.Rmd</code></a></small>
      <div class="hidden name"><code>MungeSumstats.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use the <em>MungeSumstats</em> package, please cite</p>
<p><a href="https://academic.oup.com/bioinformatics/advance-article/doi/10.1093/bioinformatics/btab665/6380562" class="external-link">Murphy
et al. MungeSumstats: A Bioconductor package for the standardisation and
quality control of many GWAS summary statistics</a>.</p>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <em>MungeSumstats</em> package is designed to facilitate the
standardisation of GWAS summary statistics as utilised in our Nature
Genetics paper<span class="citation"><sup>1</sup></span>.</p>
<p>The package is designed to handle the lack of standardisation of
output files by the GWAS community. There is a group who have now
manually standardised many GWAS: <a href="https://mrcieu.github.io/ieugwasr/" class="external-link">R interface to the IEU GWAS
database API • ieugwasr</a> and <a href="https://github.com/MRCIEU/gwasvcf" class="external-link">gwasvcf</a> but because a lot
of GWAS remain closed access, these repositories are not all
encompassing.</p>
<p>The <a href="https://github.com/mikegloudemans/gwas-download" class="external-link">GWAS-Download
project</a> has collated summary statistics from 200+ GWAS. This
repository has been utilsed to identify the most common formats, all of
which can be standardised with <em>MungeSumstats</em>.</p>
<p>Moreover, there is an emerging standard of VCF format for summary
statistics files with multiple, useful, associated R packages such as
<em>vcfR</em>. However, there is currently no method to convert VCF
formats to a standardised format that matches older approaches.</p>
<p>The <em>MungeSumstats</em> package standardises both VCF and the most
common summary statistic file formats to enable downstream integration
and analysis.</p>
<p><em>MungeSumstats</em> also offers comprehensive Quality Control (QC)
steps which are important prerequisites for downstream analysis like
Linkage disequilibrium score regression (LDSC) and MAGMA.</p>
<p>Moreover, <em>MungeSumstats</em> is efficiently written resulting in
all reformatting and quality control checks completing in minutes for
GWAS summary statistics with 500k SNPs on a standard desktop machine.
This speed can be increased further by increasing the number of threads
(nThread) for <code>data.table</code> to use.</p>
<p>Currently <em>MungeSumstats</em> only works on data from humans, as
it uses human-based genome references.</p>
</div>
<div class="section level2">
<h2 id="aim">Aim<a class="anchor" aria-label="anchor" href="#aim"></a>
</h2>
<p><em>MungeSumstats</em> will ensure that the all essential columns for
analysis are present and syntactically correct. Generally, summary
statistic files include (but are not limited to) the columns:</p>
<ul>
<li>SNP : SNP ID (rs IDs)</li>
<li>CHR : Chromosome number</li>
<li>BP : Base pair positions</li>
<li>A1 : reference allele</li>
<li>A2 : alternative allele</li>
<li>Z : Z-score</li>
<li>BETA : Effect size estimate relative to the alternative allele</li>
<li>P : Unadjusted p-value for SNP</li>
<li>SE : The standard error</li>
<li>N : Sample size</li>
<li>INFO: The imputation information score</li>
<li>FRQ: The minor/effect allele frequency (MAF/EAF) of the SNP</li>
</ul>
<p><em>MungeSumstats</em> uses a mapping file to infer the inputted
column names (run <code>data("sumstatsColHeaders")</code> to view
these). This mapping file is far more comprehensive than any other
publicly available munging tool containing more than 200 unique mappings
at the time of writing this vignette. However, if your column headers
are missing or if you want to change the mapping, you can do so by
passing your own mapping file (see
<code>format_sumstats(mapping_file)</code>).</p>
<p><em>MungeSumstats</em> offers unmatched levels of quality control to
ensure, for example, consistency of allele assignment and direction of
effects. Tests run by <em>MungeSumstats</em> include:</p>
<ul>
<li>Check VCF format</li>
<li>Check tab, space or comma delimited, zipped, csv or tsv file</li>
<li>Check for header name synonyms</li>
<li>Check for multiple models or traits in GWAS</li>
<li>Check for uniformity in SNP ID - no mix of rs/missing rs/chr:bp</li>
<li>Check for CHR:BP:A2:A1 all in one column</li>
<li>Check for CHR:BP in one column</li>
<li>Check for A1/A2 in one column</li>
<li>Check if CHR and/or BP is missing (infer from reference genome)</li>
<li>Check if SNP ID is missing (infer from reference genome)</li>
<li>Check if A1 and/or A2 are missing (infer from reference genome)</li>
<li>Check that vital columns are present (SNP,CHR,BP,P,A1,A2)</li>
<li>Check for one signed/effect column
(Z,OR,BETA,LOG_ODDS,SIGNED_SUMSTAT)</li>
<li>Check for missing data</li>
<li>Check for duplicated columns</li>
<li>Check for small p-values (lower than 5e-324)</li>
<li>Check N column is an integer</li>
<li>Check for SNPs with N greater than 5 times standard dev. plus the
mean</li>
<li>Check SNPs are RS ID’s</li>
<li>Check for uniformity of SNP ID format</li>
<li>Check for duplicated rows, based on SNP ID</li>
<li>Check for duplicated rows, based on base-pair position</li>
<li>Check for SNPs on reference genome. Correct not found SNP IDs using
CHR and BP (infer from reference genome)</li>
<li>Check INFO score</li>
<li>Check FRQ value</li>
<li>Check FRQ is minor allele frequency (MAF)</li>
<li>Check that the SNPs’ standard error (SE) is positive</li>
<li>Check that SNPs’ effect columns (like BETA) aren’t equal to 0</li>
<li>Check for strand-ambiguous SNPs</li>
<li>Check for non-biallelic SNPs (infer from reference genome)</li>
<li>Check for allele flipping</li>
<li>Check for SNPs with nonstandard chromosome names</li>
<li>Check for SNPs on excluded chromosomes (removes non-autosomal SNPs
by default)</li>
<li>Check for z-score (Z) and impute if missing</li>
<li>Check for N and impute if missing</li>
<li>Check output format is LDSC ready</li>
<li>Check output format is IEU OpenGWAS ready</li>
<li>Check and perform liftover to desired reference genome if
necessary</li>
<li>Check for indels in the sumstats and drop them if found (not run by
default)</li>
</ul>
<p>Users can specify which checks to run on their data. A
<strong>note</strong> on the allele flipping check:
<strong>MungeSumstats</strong> infers the effect allele will always be
the A2 allele, this is the approach done for <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7805039/" class="external-link">IEU GWAS
VCF</a> and has such also been adopted here. This inference is first
from the inputted file’s column headers however, the allele flipping
check ensures this by comparing A1, what should be the reference allele,
to the reference genome. If a SNP’s A1 DNA base doesn’t match the
reference genome but it’s A2 (what should be the alternative allele)
does, the alleles will be flipped along with the effect information
(e.g. Beta, Odds Ratio, signed summary statistics, FRQ, Z-score*).</p>
<p>*-by default the Z-score is assumed to be calculated off the effect
size not the P-value and so will be flipped. This can be changed by a
user.</p>
<p>If a test is failed, the user will be notified and if possible, the
input will be corrected. The QC steps from the checks above can also be
adjusted to suit the user’s analysis, see
<code><a href="../reference/format_sumstats.html">MungeSumstats::format_sumstats</a></code>.</p>
<p><em>MungeSumstats</em> can handle VCF, txt, tsv, csv file types or
.gz/.bgz versions of these file types. The package also gives the user
the flexibility to export the reformatted file as tab-delimited, VCF or
R native objects such as data.table, GRanges or VRanges objects. The
output can also be outputted in an <strong>LDSC ready</strong> format
which means the file can be fed directly into LDSC without the need for
additional munging. <strong>NOTE</strong> - If LDSC format is used, the
naming convention of A1 as the reference (genome build) allele and A2 as
the effect allele will be reversed to match LDSC (A1 will now be the
effect allele). See more info on this <a href="https://groups.google.com/g/ldsc_users/c/S7FZK743w68" class="external-link">here</a>.
Note that any effect columns (e.g. Z) will be inrelation to A1 now
instead of A2.</p>
<p>Please read carefully through our <a href="https://github.com/Al-Murphy/MungeSumstats/wiki/FAQ" class="external-link">FAQ
Website</a> to gain insight on how best to run MungeSumstats on your
data.</p>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>The <em>MungeSumstats</em> package contains small subsets of GWAS
summary statistics files. Firstly, on Educational Attainment by Okbay et
al 2016: PMID: 27898078 PMCID: PMC5509058 DOI: 10.1038/ng1216-1587b.</p>
<p>Secondly, a VCF file (VCFv4.2) relating to the GWAS Amyotrophic
lateral sclerosis from ieu open GWAS project. Dataset: ebi-a-GCST005647:
<a href="https://gwas.mrcieu.ac.uk/datasets/ebi-a-GCST005647/" class="external-link uri">https://gwas.mrcieu.ac.uk/datasets/ebi-a-GCST005647/</a></p>
<p>These datasets will be used to showcase <em>MungeSumstats</em>
functionality.</p>
</div>
<div class="section level2">
<h2 id="running-mungesumstats">Running <em>MungeSumstats</em><a class="anchor" aria-label="anchor" href="#running-mungesumstats"></a>
</h2>
<p><em>MungeSumstats</em> is available on Bioconductor. To install the
package on Bioconductor run the following lines of code:</p>
<pre><code><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/" class="external-link">"BiocManager"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"MungeSumstats"</span><span class="op">)</span></span></code></pre>
<p>Once installed, load the package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/neurogenomics/MungeSumstats" class="external-link">MungeSumstats</a></span><span class="op">)</span></span></code></pre></div>
<p>To standardise the summary statistics’ file format, simply call
<code><a href="../reference/format_sumstats.html">format_sumstats()</a></code> passing in the path to your summary
statistics file or directly pass the summary statistics as a dataframe
or datatable. You can specify which genome build was used in the
GWAS(GRCh37 or GRCh38) or, as default, infer the genome build from the
data.The reference genome is used for multiple checks like deriving
missing data such SNP/BP/CHR/A1/A2 and for QC steps like removing
non-biallelic SNPs, strand-ambiguous SNPs or ensuring correct allele and
direction of SNP effects. The path to the reformatted summary statistics
file can be returned by the function call, the user can specify a
location to save the file or the user can return an R native object for
the data: data.table, VRanges or GRanges object.</p>
<p>Note that for a number of the checks implored by
<em>MungeSumstats</em> a reference genome is used. If your GWAS summary
statistics file of interest relates to <em>GRCh38</em>, you will need to
install <code>SNPlocs.Hsapiens.dbSNP155.GRCh38</code> and
<code>BSgenome.Hsapiens.NCBI.GRCh38</code> from Bioconductor as
follows:</p>
<pre><code><span><span class="co">#increase permissible time to download data, in case of slow internet access</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>timeout<span class="op">=</span><span class="fl">2000</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"SNPlocs.Hsapiens.dbSNP155.GRCh38"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"BSgenome.Hsapiens.NCBI.GRCh38"</span><span class="op">)</span></span></code></pre>
<p>If your GWAS summary statistics file of interest relates to
<em>GRCh37</em>, you will need to install
<code>SNPlocs.Hsapiens.dbSNP155.GRCh37</code> and
<code>BSgenome.Hsapiens.1000genomes.hs37d5</code> from Bioconductor as
follows:</p>
<pre><code><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"SNPlocs.Hsapiens.dbSNP155.GRCh37"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"BSgenome.Hsapiens.1000genomes.hs37d5"</span><span class="op">)</span></span></code></pre>
<p>These may take some time to install and are not included in the
package as some users may only need one of
<em>GRCh37</em>/<em>GRCh38</em>.</p>
<p>The Educational Attainment by Okbay GWAS summary statistics file is
saved as a text document in the package’s external data folder so we can
just pass the file path to it straight to <em>MungeSumstats</em>.</p>
<p><strong>NOTE</strong> - By default, Formatted results will be saved
to <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>. This means all formatted summary stats will
be deleted upon ending the R session if not copied to a local file path.
Otherwise, to keep formatted summary stats, change
<code>save_path</code> (
e.g.<code>file.path('./formatted',basename(path))</code>), or make sure
to copy files elsewhere after processing (
e.g.<code>file.copy(save_path, './formatted/' )</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eduAttainOkbayPth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"eduAttainOkbay.txt"</span>,</span>
<span>                                  package<span class="op">=</span><span class="st">"MungeSumstats"</span><span class="op">)</span></span>
<span><span class="va">reformatted</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/format_sumstats.html">format_sumstats</a></span><span class="op">(</span>path<span class="op">=</span><span class="va">eduAttainOkbayPth</span>,</span>
<span>                                 ref_genome<span class="op">=</span><span class="st">"GRCh37"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ******::NOTE::******</span></span>
<span><span class="co">##  - Formatted results will be saved to `tempdir()` by default.</span></span>
<span><span class="co">##  - This means all formatted summary stats will be deleted upon ending the R session.</span></span>
<span><span class="co">##  - To keep formatted summary stats, change `save_path`  ( e.g. `save_path=file.path('./formatted',basename(path))` ),   or make sure to copy files elsewhere after processing  ( e.g. `file.copy(save_path, './formatted/' )`.</span></span>
<span><span class="co">##  ********************</span></span></code></pre>
<pre><code><span><span class="co">## Formatted summary statistics will be saved to ==&gt;  /var/folders/hd/jm8lzp7s4dl_wlkykzhz66x80000gn/T//RtmpJonkzo/filec4ec6d3b393.tsv.gz</span></span></code></pre>
<pre><code><span><span class="co">## Warning: replacing previous import 'utils::findMatches' by</span></span>
<span><span class="co">## 'S4Vectors::findMatches' when loading 'SNPlocs.Hsapiens.dbSNP155.GRCh37'</span></span></code></pre>
<pre><code><span><span class="co">## Importing tabular file: /private/var/folders/hd/jm8lzp7s4dl_wlkykzhz66x80000gn/T/RtmpKLvRpi/temp_libpath17f3d19176b21/MungeSumstats/extdata/eduAttainOkbay.txt</span></span></code></pre>
<pre><code><span><span class="co">## Checking for empty columns.</span></span></code></pre>
<pre><code><span><span class="co">## Infer Effect Column</span></span></code></pre>
<pre><code><span><span class="co">## First line of summary statistics file:</span></span></code></pre>
<pre><code><span><span class="co">## MarkerName   CHR POS A1  A2  EAF Beta    SE  Pval    </span></span></code></pre>
<pre><code><span><span class="co">## Allele columns are ambiguous, attempting to infer direction</span></span></code></pre>
<pre><code><span><span class="co">## Can't infer allele columns from sumstats</span></span></code></pre>
<pre><code><span><span class="co">## Standardising column headers.</span></span></code></pre>
<pre><code><span><span class="co">## First line of summary statistics file:</span></span></code></pre>
<pre><code><span><span class="co">## MarkerName   CHR POS A1  A2  EAF Beta    SE  Pval    </span></span></code></pre>
<pre><code><span><span class="co">## Summary statistics report:</span></span>
<span><span class="co">##    - 93 rows</span></span>
<span><span class="co">##    - 93 unique variants</span></span>
<span><span class="co">##    - 70 genome-wide significant variants (P&lt;5e-8)</span></span>
<span><span class="co">##    - 20 chromosomes</span></span></code></pre>
<pre><code><span><span class="co">## Checking for multi-GWAS.</span></span></code></pre>
<pre><code><span><span class="co">## Checking for multiple RSIDs on one row.</span></span></code></pre>
<pre><code><span><span class="co">## Checking SNP RSIDs.</span></span></code></pre>
<pre><code><span><span class="co">## Checking for merged allele column.</span></span></code></pre>
<pre><code><span><span class="co">## Checking A1 is uppercase</span></span></code></pre>
<pre><code><span><span class="co">## Checking A2 is uppercase</span></span></code></pre>
<pre><code><span><span class="co">## Checking for incorrect base-pair positions</span></span></code></pre>
<pre><code><span><span class="co">## Checking for missing data.</span></span></code></pre>
<pre><code><span><span class="co">## Checking for duplicate columns.</span></span></code></pre>
<pre><code><span><span class="co">## Checking for duplicated rows.</span></span></code></pre>
<pre><code><span><span class="co">## INFO column not available. Skipping INFO score filtering step.</span></span></code></pre>
<pre><code><span><span class="co">## Filtering SNPs, ensuring SE&gt;0.</span></span></code></pre>
<pre><code><span><span class="co">## Ensuring all SNPs have N&lt;5 std dev above mean.</span></span></code></pre>
<pre><code><span><span class="co">## 47 SNPs (50.5%) have FRQ values &gt; 0.5. Conventionally the FRQ column is intended to show the minor/effect allele frequency.</span></span>
<span><span class="co">## The FRQ column was mapped from one of the following from the inputted  summary statistics file:</span></span>
<span><span class="co">## FRQ, EAF, FREQUENCY, FRQ_U, F_U, MAF, FREQ, FREQ_TESTED_ALLELE, FRQ_TESTED_ALLELE, FREQ_EFFECT_ALLELE, FRQ_EFFECT_ALLELE, EFFECT_ALLELE_FREQUENCY, EFFECT_ALLELE_FREQ, EFFECT_ALLELE_FRQ, A2FREQ, A2FRQ, ALLELE_FREQUENCY, ALLELE_FREQ, ALLELE_FRQ, AF, MINOR_AF, EFFECT_AF, A2_AF, EFF_AF, ALT_AF, ALTERNATIVE_AF, INC_AF, A_2_AF, TESTED_AF, ALLELEFREQ, ALT_FREQ, EAF_HRC, EFFECTALLELEFREQ, FREQ.B, FREQ_EUROPEAN_1000GENOMES, FREQ_HAPMAP, FREQ_TESTED_ALLELE_IN_HRS, FRQ_U_113154, FRQ_U_31358, FRQ_U_344901, FRQ_U_43456, POOLED_ALT_AF, AF_ALT, AF.ALT, AF-ALT, ALT.AF, ALT-AF, A2.AF, A2-AF, AF.EFF, AF_EFF, ALL_AF</span></span></code></pre>
<pre><code><span><span class="co">## As frq_is_maf=TRUE, the FRQ column will not be renamed. If the FRQ values were intended to represent major allele frequency,</span></span>
<span><span class="co">## set frq_is_maf=FALSE to rename the column as MAJOR_ALLELE_FRQ and differentiate it from minor/effect allele frequency.</span></span></code></pre>
<pre><code><span><span class="co">## Sorting coordinates with 'data.table'.</span></span></code></pre>
<pre><code><span><span class="co">## Writing in tabular format ==&gt; /var/folders/hd/jm8lzp7s4dl_wlkykzhz66x80000gn/T//RtmpJonkzo/filec4ec6d3b393.tsv.gz</span></span></code></pre>
<pre><code><span><span class="co">## Summary statistics report:</span></span>
<span><span class="co">##    - 93 rows (100% of original 93 rows)</span></span>
<span><span class="co">##    - 93 unique variants</span></span>
<span><span class="co">##    - 70 genome-wide significant variants (P&lt;5e-8)</span></span>
<span><span class="co">##    - 20 chromosomes</span></span></code></pre>
<pre><code><span><span class="co">## Done munging in 0.051 minutes.</span></span></code></pre>
<pre><code><span><span class="co">## Successfully finished preparing sumstats file, preview:</span></span></code></pre>
<pre><code><span><span class="co">## Reading header.</span></span></code></pre>
<pre><code><span><span class="co">##           SNP   CHR       BP     A1     A2     FRQ   BETA    SE         P</span></span>
<span><span class="co">##        &lt;char&gt; &lt;int&gt;    &lt;int&gt; &lt;char&gt; &lt;char&gt;   &lt;num&gt;  &lt;num&gt; &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">## 1:   rs301800     1  8490603      T      C 0.17910  0.019 0.003 1.794e-08</span></span>
<span><span class="co">## 2: rs11210860     1 43982527      A      G 0.36940  0.017 0.003 2.359e-10</span></span>
<span><span class="co">## 3: rs34305371     1 72733610      A      G 0.08769  0.035 0.005 3.762e-14</span></span>
<span><span class="co">## 4:  rs2568955     1 72762169      T      C 0.23690 -0.017 0.003 1.797e-08</span></span></code></pre>
<pre><code><span><span class="co">## Returning path to saved data.</span></span></code></pre>
<p>Here we know the summary statistics are based on the reference genome
GRCh37, GRCh38 can also be inputted. Moreover, if you are unsure of the
genome build, leave it as <code>NULL</code> and Mungesumstats will infer
it from the data.</p>
<p>Also note that the default dbSNP version used along with the
reference genome is the latest version available on Bioconductor
(currently dbSNP 155) but older versions are also availble. Use the
<code>dbSNP</code> input parameter to control this.</p>
<p>The arguments <code>format_sumstats</code> in that control the level
of QC conducted by <em>MungeSumstats</em> are:</p>
<ul>
<li>
<strong>convert_small_p</strong> Binary, should
<code>p-values &lt; 5e-324</code> be converted to 0? Small p-values pass
the R limit and can cause errors with LDSC/MAGMA and should be
converted. Default is TRUE.</li>
<li>
<strong>convert_large_p</strong> Binary, should p-values &gt;1 be
converted to 1? P-values &gt;1 should not be possible and can cause
errors with LDSC/MAGMA and should be converted. Default is TRUE.</li>
<li>
<strong>convert_neg_p</strong> Binary, should p-values &lt;0 be
converted to 0? Negative p-values should not be possible and can cause
errors with LDSC/MAGMA and should be converted. Default is TRUE.</li>
<li>
<strong>compute_z</strong> Whether to compute Z-score column from P.
Default is FALSE. <strong>Note</strong> that imputing the Z-score for
every SNP will not correct be perfectly correct and may result in a loss
of power. This should only be done as a last resort.</li>
<li>
<strong>force_new_z</strong> When a “Z” column already exists, it
will be used by default. To override and compute a new Z-score column
from P set to TRUE.</li>
<li>
<strong>compute_n</strong> Whether to impute N. Default of 0 won’t
impute, any other integer will be imputed as the N (sample size) for
every SNP in the dataset. <strong>Note</strong> that imputing the sample
size for every SNP is not correct and should only be done as a last
resort. N can also be inputted with “ldsc”, “sum”, “giant” or “metal” by
passing one of these for this field or a vector of multiple. Sum and an
integer value creates an N column in the output whereas giant, metal or
ldsc create an Neff or effective sample size. If multiples are passed,
the formula used to derive it will be indicated.</li>
<li>
<strong>convert_n_int</strong> Binary, if N (the number of samples)
is not an integer, should this be rounded? Default is TRUE.
analysis_trait If multiple traits were studied, name of the trait for
analysis from the GWAS. Default is NULL.</li>
<li>
<strong>impute_beta</strong> Binary, whether BETA should be imputed
using other effect data if it isn’t present in the sumstats. Note that
this imputation is an approximation so could have an effect on
downstream analysis. Use with caution. The different methods
MungeSumstats will try and impute beta (in this order or priority) are:
1. log(OR) 2. Z x SE. Default value is FALSE.</li>
<li>
<strong>es_is_beta</strong> Binary, whether to map ES to BETA. We
take BETA to be any BETA-like value (including Effect Size). If this is
not the case for your sumstats, change this to FALSE. Default is
TRUE.</li>
<li>
<strong>impute_se</strong> Binary, whether the standard error should
be imputed using other effect data if it isn’t present in the sumstats.
Note that this imputation is an approximation so could have an effect on
downstream analysis. Use with caution. The different methods
MungeSumstats will try and impute se (in this order or priority) are: 1.
BETA / Z
<ol start="2" style="list-style-type: decimal">
<li>abs(BETA/ qnorm(P/2)). Default value is FALSE.</li>
</ol>
</li>
<li>
<strong>analysis_trait</strong> If multiple traits were studied,
name of the trait for analysis from the GWAS. Default is NULL.</li>
<li>
<strong>INFO_filter</strong> 0-1 The minimum value permissible of
the imputation information score (if present in sumstatsfile). Default
0.9</li>
<li>
<strong>FRQ_filter</strong> 0-1 The minimum value permissible of the
frequency(FRQ) of the SNP (i.e. Allele Frequency (AF)) (if present in
sumstats file). By default no filtering is done, i.e. value of 0.<br>
</li>
<li>
<strong>pos_se</strong> Binary Should the standard Error (SE) column
be checked to ensure it is greater than 0? Those that are, are removed
(if present in sumstats file). Default TRUE.</li>
<li>
<strong>effect_columns_nonzero</strong> Binary should the effect
columns in the data BETA,OR (odds ratio),LOG_ODDS,SIGNED_SUMSTAT be
checked to ensure no SNP=0. Those that do are removed(if present in
sumstats file). Default TRUE.<br>
</li>
<li>
<strong>N_std</strong> Numeric, the number of standard deviations
above the mean a SNP’s N is needed to be removed. Default is 5.
<strong>N_dropNA</strong> controls whether the SNPs with a missing N
value are dropped or not (Default is TRUE).</li>
<li>
<strong>N_dropNA</strong> Drop rows where N is missing.Default is
TRUE.</li>
<li>
<strong>chr_style</strong> Chromosome naming style to use in the
formatted summary statistics file (“NCBI”, “UCSC”, “dbSNP”, or
“Ensembl”). The NCBI and Ensembl styles both code chromosomes as
<code>1-22, X, Y, MT</code>; the UCSC style is
<code>chr1-chr22, chrX, chrY, chrM</code>; and the dbSNP style is
<code>ch1-ch22, chX, chY, chMT</code>. Default is Ensembl.</li>
<li>
<strong>rmv_chr</strong> Chromosomes to exclude from the formatted
summary statistics file. Use NULL if no filtering is necessary. Default
is <code>c("X", "Y", "MT")</code> which removes all non-autosomal
SNPs.</li>
<li>
<strong>on_ref_genome</strong> Binary, should a check take place
that all SNPs are on the reference genome by SNP ID. Any SNPs not on the
reference genome, will be corrected from the reference genome (if
possible) using the chromosome and base pair position data. Default is
TRUE</li>
<li>
<strong>convert_ref_genome</strong> name of the reference genome to
convert to (“GRCh37” or “GRCh38”). This will only occur if the current
genome build does not match. Default is not to convert the genome build
(NULL).<br>
</li>
<li>
<strong>strand_ambig_filter</strong> Binary, should SNPs with
strand-ambiguous alleles be removed. Default is FALSE</li>
<li>
<strong>allele_flip_check</strong> Binary, should the allele columns
be checked against reference genome to infer if flipping is necessary.
Default is TRUE. <strong>allele_flip_drop</strong> controls whether the
SNPs for which neither their A1 or A2 base pair values match a reference
genome be dropped. Default is TRUE. <strong>allele_flip_z</strong>
controls whether the Z-score value should be flipped along with effect
and FRQ columns (e.g. Beta). Default is TRUE.
<strong>allele_flip_frq</strong> controls whether the frequency (FRQ)
value should be flipped along with effect and Z-score columns
(e.g. Beta). Default is TRUE.</li>
<li>
<strong>bi_allelic_filter</strong> Binary, should non-biallelic SNPs
be removed. Default is TRUE</li>
<li>
<strong>flip_frq_as_biallelic</strong> Binary, Should non-bi-allelic
SNPs frequency values be flipped as 1-p despite there being other
alternative alleles? Default is FALSE but if set to TRUE, this allows
non-bi-allelic SNPs to be kept despite needing flipping.<br>
</li>
<li>
<strong>snp_ids_are_rs_ids</strong> Binary, should the SNP IDs
inputted be inferred as RS IDs or some arbitrary ID. Default is
TRUE.<br>
</li>
<li>
<strong>remove_multi_rs_snp</strong> Binary Sometimes summary
statistics can have multiple RSIDs on one row (i.e. related to one SNP),
for example “rs5772025_rs397784053”. This can cause an error so by
default, the first RS ID will be kept and the rest removed
e.g.”rs5772025”. If you want to just remove these SNPs entirely, set it
to TRUE. Default is FALSE.</li>
<li>
<strong>frq_is_maf</strong> Binary, conventionally the FRQ column is
intended to show the minor/effect allele frequency (MAF) but sometimes
the major allele frequency can be inferred as the FRQ column. This
logical variable indicates that the FRQ column should be renamed to
MAJOR_ALLELE_FRQ if the frequency values appear to relate to the major
allele i.e. &gt;0.5. By default mapping won’t occur i.e. is TRUE.</li>
<li>
<strong>indels</strong> Binary does your Sumstats file contain
Indels? These don’t exist in our reference file so they will be excluded
from checks if this value is TRUE. Further information -the reference
dataset we use in MSS (dbSNP) does not include indels so any checks like
is the SNP on the reference genome, attempts to impute any missing data
for indels or check the direction of the effect columns can not be done
for indels. Indels will be kept in the dataset if possible but certain
situations (like if there is missing data) can cause an indel to be
removed. See the printed information by MSS during your run to know if
this affects you. Default is TRUE.</li>
<li>
<strong>drop_indels</strong> Binary should any indels found in the
sumstats be dropped? These can not be checked against a reference
dataset and will have the same RS ID and position as SNPs which can
affect downstream analysis. Default is False.<br>
</li>
<li>
<strong>drop_na_cols</strong> A character vector of column names to
be checked for missing values. Rows with missing values in any of these
columns (if present in the dataset) will be dropped. If
<code>NULL</code>, all columns will be checked for missing values.
Default columns are SNP, chromosome, position, allele 1, allele 2,
effect columns (frequency, beta, Z-score, standard error, log odds,
signed sumstats, odds ratio), p value and N columns.</li>
<li>
<strong>dbSNP</strong> The dbSNP version to use as a reference -
defaults to the most recent version available (155). Note that with the
9x more SNPs in dbSNP 155 vs 144, run times will increase.</li>
<li>
<strong>sort_coordinates</strong> Whether to sort by coordinates of
resulting sumstats.<br>
</li>
<li>
<strong>nThread</strong> Number of threads to use for parallel
processes.</li>
<li>
<strong>write_vcf</strong> Whether to write as VCF (TRUE) or tabular
file (FALSE). While <strong>tabix_index</strong> is a binary input for
whether to index the formatted summary statistics with <a href="http://www.htslib.org/doc/tabix.html" class="external-link">tabix</a> for fast
querying.</li>
<li>
<strong>return_data</strong> Return <code>data.table</code>,
<code>GRanges</code> or <code>VRanges</code>directly to user. Otherwise,
return the path to the save data. Default is FALSE.</li>
<li>
<strong>return_format</strong> If return_data is TRUE. Object type
to be returned (“data.table”,“vranges”,“granges”).</li>
<li>
<strong>save_format</strong> Ensure that output format meets all
requirements to be passed directly into LDSC (“ldsc”) without the need
for additional munging or for IEU OpenGWAS format (“opengwas”) before
saving as a VCF. <strong>NOTE</strong> - If LDSC format is used, the
naming convention of A1 as the reference (genome build) allele and A2 as
the effect allele will be reversed to match LDSC (A1 will now be the
effect allele). See more info on this <a href="https://groups.google.com/g/ldsc_users/c/S7FZK743w68" class="external-link">here</a>.
Note that any effect columns (e.g. Z) will be inrelation to A1 now
instead of A2.</li>
<li>
<strong>log_folder_ind</strong> Should log files be stored
containing all filtered out SNPs (separate file per filter). The data is
outputted in the same format specified for the resulting sumstats
file.</li>
<li>
<strong>log_mungesumstats_msgs</strong> Binary Should a log be
stored containing all messages and errors printed by MungeSumstats in a
run.</li>
<li>
<strong>imputation_ind</strong> Binary Should a column be added for
each imputation step to show what SNPs have imputed values for differing
fields. This includes a field denoting SNP allele flipping (flipped). On
the flipped value, this denoted whether the alelles where switched based
on MungeSumstats initial choice of A1, A2 from the input column headers
and thus may not align with what the creator
intended.<strong>Note</strong> these columns will be in the formatted
summary statistics returned.</li>
<li>
<strong>log_folder</strong> File path to the directory for the log
files and the log of MungeSumstats messages to be stored. Default is a
temporary directory.</li>
<li>
<strong>force_new</strong> If a formatted file of the same names as
exists, formatting will be skipped and this file will be imported
instead (default). Set to override this.</li>
<li>
<strong>mapping_file</strong> MungeSumstats has a pre-defined
column-name mapping file which should cover the most common column
headers and their interpretations. However, if a column header that is
in youf file is missing of the mapping we give is incorrect you can
supply your own mapping file. Must be a 2 column dataframe with column
names “Uncorrected” and “Corrected”. See
<code>data(sumstatsColHeaders)</code> for default mapping and necessary
format.</li>
</ul>
<p>See <code>?MungeSumstats::format_sumstats()</code> for the full list
of parameters to control MungeSumstats QC and standardisation steps.</p>
<p>VCF files can also be standardised to the same format as other
summary statistic files. A subset of the Amyotrophic lateral sclerosis
GWAS from the ieu open GWAS project (a .vcf file) has been added to
<em>MungeSumstats</em> to demonstrate this functionality.Simply pass the
path to the file in the same manner you would for other summary
statistic files:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#save ALS GWAS from the ieu open GWAS project to a temp directory</span></span>
<span><span class="va">ALSvcfPth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"ALSvcf.vcf"</span>, package<span class="op">=</span><span class="st">"MungeSumstats"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reformatted_vcf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/format_sumstats.html">format_sumstats</a></span><span class="op">(</span>path<span class="op">=</span><span class="va">ALSvcfPth</span>, </span>
<span>                                 ref_genome<span class="op">=</span><span class="st">"GRCh37"</span><span class="op">)</span></span></code></pre></div>
<p>You can also get more information on the SNPs which have had data
imputed or have been filtered out by <em>MungeSumstats</em> by using the
<code>imputation_ind</code> and <code>log_folder_ind</code> parameters
respectively. For example:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#set</span></span>
<span><span class="va">reformatted_vcf_2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/format_sumstats.html">format_sumstats</a></span><span class="op">(</span>path<span class="op">=</span><span class="va">ALSvcfPth</span>,</span>
<span>                                 ref_genome<span class="op">=</span><span class="st">"GRCh37"</span>,</span>
<span>                                 log_folder_ind<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                 imputation_ind<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                 log_mungesumstats_msgs<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Time difference of 0.1 secs</span></span></code></pre>
<pre><code><span><span class="co">## Time difference of 0.4 secs</span></span></code></pre>
<p>Check the file <code>snp_bi_allelic.tsv.gz</code> in the
<code>log_folder</code> directory you supply (by default a temp
directory), for a list of SNPs removed as they are non-bi-allelic. The
text files containing the console output and messages are also stored in
the same directory.</p>
<p>Note you can also control the dbSNP version used as a reference
dataset by MungeSumstats using the <code>dbSNP</code> parameter. By
default this will be set to the most recent dbSNP version available
(155).</p>
<p>Note that using <code>log_folder_ind</code> returns a list from
<code>format_sumstats</code> which includes the file locations of the
differing classes of removed SNPs. Using
<code>log_mungesumstats_msgs</code> saves the messages to the console to
a file which is returned in the same list. Note that not all the
messages will also print to screen anymore when you set
<code>log_mungesumstats_msgs</code>:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">reformatted_vcf_2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "sumstats"  "log_files"</span></span></code></pre>
<p>A user can load a file to view the excluded SNPs.</p>
<p>In this case, SNPs were filtered based on non-bi-allelic
criterion:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">reformatted_vcf_2</span><span class="op">$</span><span class="va">log_files</span><span class="op">$</span><span class="va">snp_bi_allelic</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<p>The different types of exclusion which lead to the names are
explained below:</p>
<ul>
<li>
<strong>snp_multi_rs_one_row</strong> - Where the SNP (RS ID)
contained more than one RS ID.</li>
<li>
<strong>snp_missing_rs</strong> - Where the SNP (RS ID) was missing
the rs prefix. Note that these are only removed when other snps have an
rs prefix.</li>
<li>
<strong>snp_multi_colon</strong> - Where the SNP ID has mutliple
colons (“:”) in one SNP.</li>
<li>
<strong>snp_not_found_from_bp_chr</strong> - Where the RS ID was
attempted to be imputed from the CHR and BP (Base-Pair) information,
using the reference genome, but wasn’t successful.</li>
<li>
<strong>chr_bp_not_found_from_snp</strong> - Where the CHR and BP
(Base-Pair) was attempted to be imputed from the SNP (RS ID), using the
reference genome, but wasn’t successful.</li>
<li>
<strong>alleles_not_found_from_snp</strong> - Where the alleles (A1
and/or A2) was attempted to be imputed from the SNP (RS ID), using the
reference genome, but wasn’t successful.</li>
<li>
<strong>alleles_dont_match_ref_gen</strong> - Where the alleles (A1
and/or A2) don’t match what’s on the reference genome.</li>
<li>
<strong>missing_data</strong> - Where there is data missing across
the inputted columns.</li>
<li>
<strong>dup_snp_id</strong> - Where the SNP ID is duplicated in the
input.</li>
<li>
<strong>dup_base_pair_position</strong> - Where the base-pair
position is duplicated in the input.</li>
<li>
<strong>info_filter</strong> - SNP INFO value below the specified
threshold.</li>
<li>
<strong>se_neg</strong> - SNPs SE (Standard Error) value is 0 or
negative.</li>
<li>
<strong>effect_col_zero</strong> - SNPs effect column(s) value is
zero e.g. BETA=0.</li>
<li>
<strong>n_large</strong> - SNPs N is N standard deviations greater
than the mean.</li>
<li>
<strong>n_null</strong> - SNPs N is null.</li>
<li>
<strong>chr_excl</strong> - SNP has an unrecognized chromosome name
or is on a chromosome that was specified to be excluded.</li>
<li>
<strong>snp_strand_ambiguous</strong> - SNP is strand
ambiguous.</li>
<li>
<strong>snp_bi_allelic</strong> - SNP is not bi-allelic.</li>
<li>
<strong>MungeSumstats_log_msg</strong> - Text file of all messages
to the console created during MungeSumstats run.</li>
<li>
<strong>MungeSumstats_log_output</strong> - Text file of all errors
to the console created during MungeSumstats run.</li>
</ul>
<p>Note to export to another type such as R native objects including
data.table, GRanges, VRanges or save as a VCF file, set
<code>return_data=TRUE</code> and choose your
<code>return_format</code>:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#set</span></span>
<span><span class="va">reformatted_vcf_2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/format_sumstats.html">format_sumstats</a></span><span class="op">(</span>path<span class="op">=</span><span class="va">ALSvcfPth</span>,</span>
<span>                                 ref_genome<span class="op">=</span><span class="st">"GRCh37"</span>, </span>
<span>                                 log_folder_ind<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                 imputation_ind<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                 log_mungesumstats_msgs<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                 return_data<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                 return_format<span class="op">=</span><span class="st">"GRanges"</span><span class="op">)</span></span></code></pre></div>
<p>Also you can now output a VCF compatible with <a href="https://gwas.mrcieu.ac.uk/" class="external-link">IEU OpenGWAS</a> format (Note that
currently all IEU OpenGWAS sumstats are GRCh37, MungeSumstats will throw
a warning if your data isn’t GRCh37 when saving):</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#set</span></span>
<span><span class="va">reformatted_vcf_2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/format_sumstats.html">format_sumstats</a></span><span class="op">(</span>path<span class="op">=</span><span class="va">ALSvcfPth</span>,</span>
<span>                                 ref_genome<span class="op">=</span><span class="st">"GRCh37"</span>, </span>
<span>                                 write_vcf<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                 save_format <span class="op">=</span><span class="st">"openGWAS"</span><span class="op">)</span></span></code></pre></div>
<p>See our publication for further discussion of these checks and
options:</p>
<p><a href="https://academic.oup.com/bioinformatics/advance-article/doi/10.1093/bioinformatics/btab665/6380562" class="external-link">Murphy
et al. MungeSumstats: A Bioconductor package for the standardisation and
quality control of many GWAS summary statistics</a>.</p>
</div>
<div class="section level2">
<h2 id="extra-functionality">Extra Functionality<a class="anchor" aria-label="anchor" href="#extra-functionality"></a>
</h2>
<div class="section level3">
<h3 id="get-genome-builds">Get genome builds<a class="anchor" aria-label="anchor" href="#get-genome-builds"></a>
</h3>
<p><em>MungeSumstats</em> also contains a function to quickly infer the
genome build of multiple summary statistic files. This can be called
separately to <code><a href="../reference/format_sumstats.html">format_sumstats()</a></code> which is useful if you want
to just quickly check the genome build:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pass path to Educational Attainment Okbay sumstat file to a temp directory</span></span>
<span><span class="va">eduAttainOkbayPth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"eduAttainOkbay.txt"</span>,</span>
<span>                                  package <span class="op">=</span> <span class="st">"MungeSumstats"</span><span class="op">)</span></span>
<span><span class="va">ALSvcfPth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"ALSvcf.vcf"</span>, package<span class="op">=</span><span class="st">"MungeSumstats"</span><span class="op">)</span></span>
<span><span class="va">sumstats_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ss1 <span class="op">=</span> <span class="va">eduAttainOkbayPth</span>, ss2 <span class="op">=</span> <span class="va">ALSvcfPth</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ref_genomes</span> <span class="op">&lt;-</span> <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/get_genome_builds.html">get_genome_builds</a></span><span class="op">(</span>sumstats_list <span class="op">=</span> <span class="va">sumstats_list</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="liftover">Liftover<a class="anchor" aria-label="anchor" href="#liftover"></a>
</h3>
<p><em>MungeSumstats</em> exposes the <code><a href="../reference/liftover.html">liftover()</a></code> function
as a general utility for users.</p>
<p>Useful features include: - Automatic standardisation of genome build
names (i.e. “hg19”, “hg37”, and “GRCh37” will all be recognized as the
same genome build.) - Ability to specify <code>chrom_col</code> as well
as both <code>start_col</code> and <code>end_col</code> (for variants
that span &gt;1bp). - Ability to return in <code>data.table</code> or
<code>GRanges</code> format. - Ability to specify which chromosome
format (e.g. “chr1” vs. 1) to return <code>GRanges</code> as.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sumstats_dt</span> <span class="op">&lt;-</span> <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/formatted_example.html">formatted_example</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Standardising column headers.</span></span></code></pre>
<pre><code><span><span class="co">## First line of summary statistics file:</span></span></code></pre>
<pre><code><span><span class="co">## MarkerName   CHR POS A1  A2  EAF Beta    SE  Pval    </span></span></code></pre>
<pre><code><span><span class="co">## Sorting coordinates with 'data.table'.</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sumstats_dt_hg38</span> <span class="op">&lt;-</span> <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/liftover.html">liftover</a></span><span class="op">(</span>sumstats_dt <span class="op">=</span> <span class="va">sumstats_dt</span>, </span>
<span>                                            ref_genome <span class="op">=</span> <span class="st">"hg19"</span>,</span>
<span>                                            convert_ref_genome <span class="op">=</span> <span class="st">"hg38"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Performing data liftover from hg19 to hg38.</span></span></code></pre>
<pre><code><span><span class="co">## Converting summary statistics to GenomicRanges.</span></span></code></pre>
<pre><code><span><span class="co">## Downloading chain file...</span></span></code></pre>
<pre><code><span><span class="co">## Downloading chain file from Ensembl.</span></span></code></pre>
<pre><code><span><span class="co">## /var/folders/hd/jm8lzp7s4dl_wlkykzhz66x80000gn/T//RtmpJonkzo/GRCh37_to_GRCh38.chain.gz</span></span></code></pre>
<pre><code><span><span class="co">## Reordering so first three column headers are SNP, CHR and BP in this order.</span></span></code></pre>
<pre><code><span><span class="co">## Reordering so the fourth and fifth columns are A1 and A2.</span></span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sumstats_dt_hg38</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="14%">
<col width="5%">
<col width="11%">
<col width="3%">
<col width="3%">
<col width="10%">
<col width="8%">
<col width="7%">
<col width="7%">
<col width="26%">
</colgroup>
<thead><tr class="header">
<th align="left">SNP</th>
<th align="left">CHR</th>
<th align="right">BP</th>
<th align="left">A1</th>
<th align="left">A2</th>
<th align="right">FRQ</th>
<th align="right">BETA</th>
<th align="right">SE</th>
<th align="right">P</th>
<th align="left">IMPUTATION_gen_build</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">rs301800</td>
<td align="left">1</td>
<td align="right">8430543</td>
<td align="left">T</td>
<td align="left">C</td>
<td align="right">0.17910</td>
<td align="right">0.019</td>
<td align="right">0.003</td>
<td align="right">0e+00</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">rs11210860</td>
<td align="left">1</td>
<td align="right">43516856</td>
<td align="left">A</td>
<td align="left">G</td>
<td align="right">0.36940</td>
<td align="right">0.017</td>
<td align="right">0.003</td>
<td align="right">0e+00</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">rs34305371</td>
<td align="left">1</td>
<td align="right">72267927</td>
<td align="left">A</td>
<td align="left">G</td>
<td align="right">0.08769</td>
<td align="right">0.035</td>
<td align="right">0.005</td>
<td align="right">0e+00</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">rs2568955</td>
<td align="left">1</td>
<td align="right">72296486</td>
<td align="left">T</td>
<td align="left">C</td>
<td align="right">0.23690</td>
<td align="right">-0.017</td>
<td align="right">0.003</td>
<td align="right">0e+00</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">rs1008078</td>
<td align="left">1</td>
<td align="right">90724174</td>
<td align="left">T</td>
<td align="left">C</td>
<td align="right">0.37310</td>
<td align="right">-0.016</td>
<td align="right">0.003</td>
<td align="right">0e+00</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">rs61787263</td>
<td align="left">1</td>
<td align="right">98153158</td>
<td align="left">T</td>
<td align="left">C</td>
<td align="right">0.76120</td>
<td align="right">0.016</td>
<td align="right">0.003</td>
<td align="right">1e-07</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="quick-formatting">Quick formatting<a class="anchor" aria-label="anchor" href="#quick-formatting"></a>
</h3>
<p>In some cases, users may not want to run the full munging pipeline
provided by<br><code><a href="../reference/format_sumstats.html">MungeSumstats::format_sumstats</a></code>, but still would like to
take advantage of the file type conversion and column header
standardisation features. This will not be nearly as robust as the full
pipeline, but can still be helpful.</p>
<div class="section level4">
<h4 id="from-disk">From disk<a class="anchor" aria-label="anchor" href="#from-disk"></a>
</h4>
<p>To do this, simply run the following:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eduAttainOkbayPth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"eduAttainOkbay.txt"</span>,</span>
<span>                                  package <span class="op">=</span> <span class="st">"MungeSumstats"</span><span class="op">)</span></span>
<span><span class="va">formatted_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">"_eduAttainOkbay_standardised.tsv.gz"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#### 1. Read in the data and standardise header names ####</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/read_sumstats.html">read_sumstats</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">eduAttainOkbayPth</span>, </span>
<span>                                    standardise_headers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Importing tabular file: /private/var/folders/hd/jm8lzp7s4dl_wlkykzhz66x80000gn/T/RtmpKLvRpi/temp_libpath17f3d19176b21/MungeSumstats/extdata/eduAttainOkbay.txt</span></span></code></pre>
<pre><code><span><span class="co">## Checking for empty columns.</span></span></code></pre>
<pre><code><span><span class="co">## Standardising column headers.</span></span></code></pre>
<pre><code><span><span class="co">## First line of summary statistics file:</span></span></code></pre>
<pre><code><span><span class="co">## MarkerName   CHR POS A1  A2  EAF Beta    SE  Pval    </span></span></code></pre>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">SNP</th>
<th align="left">CHR</th>
<th align="right">BP</th>
<th align="left">A1</th>
<th align="left">A2</th>
<th align="right">FRQ</th>
<th align="right">BETA</th>
<th align="right">SE</th>
<th align="right">P</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">rs10061788</td>
<td align="left">5</td>
<td align="right">87934707</td>
<td align="left">A</td>
<td align="left">G</td>
<td align="right">0.2164</td>
<td align="right">0.021</td>
<td align="right">0.004</td>
<td align="right">0e+00</td>
</tr>
<tr class="even">
<td align="left">rs1007883</td>
<td align="left">16</td>
<td align="right">51163406</td>
<td align="left">T</td>
<td align="left">C</td>
<td align="right">0.3713</td>
<td align="right">-0.015</td>
<td align="right">0.003</td>
<td align="right">1e-07</td>
</tr>
<tr class="odd">
<td align="left">rs1008078</td>
<td align="left">1</td>
<td align="right">91189731</td>
<td align="left">T</td>
<td align="left">C</td>
<td align="right">0.3731</td>
<td align="right">-0.016</td>
<td align="right">0.003</td>
<td align="right">0e+00</td>
</tr>
<tr class="even">
<td align="left">rs1043209</td>
<td align="left">14</td>
<td align="right">23373986</td>
<td align="left">A</td>
<td align="left">G</td>
<td align="right">0.6026</td>
<td align="right">0.018</td>
<td align="right">0.003</td>
<td align="right">0e+00</td>
</tr>
<tr class="odd">
<td align="left">rs10496091</td>
<td align="left">2</td>
<td align="right">61482261</td>
<td align="left">A</td>
<td align="left">G</td>
<td align="right">0.2705</td>
<td align="right">-0.018</td>
<td align="right">0.003</td>
<td align="right">0e+00</td>
</tr>
<tr class="even">
<td align="left">rs10930008</td>
<td align="left">2</td>
<td align="right">161854736</td>
<td align="left">A</td>
<td align="left">G</td>
<td align="right">0.7183</td>
<td align="right">-0.016</td>
<td align="right">0.003</td>
<td align="right">1e-07</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### 2. Write to disk as a compressed, tab-delimited, tabix-indexed file ####</span></span>
<span><span class="va">formatted_path</span> <span class="op">&lt;-</span> <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/write_sumstats.html">write_sumstats</a></span><span class="op">(</span>sumstats_dt <span class="op">=</span> <span class="va">dat</span>,</span>
<span>                                                save_path <span class="op">=</span> <span class="va">formatted_path</span>,</span>
<span>                                                tabix_index <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                                write_vcf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                                return_path <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>   </span></code></pre></div>
<pre><code><span><span class="co">## Sorting coordinates with 'data.table'.</span></span></code></pre>
<pre><code><span><span class="co">## Writing in tabular format ==&gt; /var/folders/hd/jm8lzp7s4dl_wlkykzhz66x80000gn/T//RtmpJonkzo/filec4ec45c572ed_eduAttainOkbay_standardised.tsv</span></span></code></pre>
<pre><code><span><span class="co">## Writing uncompressed instead of gzipped to enable tabix indexing.</span></span></code></pre>
<pre><code><span><span class="co">## Converting full summary stats file to tabix format for fast querying...</span></span></code></pre>
<pre><code><span><span class="co">## Reading header.</span></span></code></pre>
<pre><code><span><span class="co">## Ensuring file is bgzipped.</span></span></code></pre>
<pre><code><span><span class="co">## Tabix-indexing file.</span></span></code></pre>
<pre><code><span><span class="co">## Removing temporary .tsv file.</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="from-data-table">From <code>data.table</code><a class="anchor" aria-label="anchor" href="#from-data-table"></a>
</h4>
<p>If you already have your data imported as an <code>data.table</code>,
you can also standardise its headers like so:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### Mess up some column names ####</span></span>
<span><span class="va">dat_raw</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/setattr.html" class="external-link">setnames</a></span><span class="op">(</span><span class="va">dat_raw</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNP"</span>,<span class="st">"CHR"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rsID"</span>,<span class="st">"Seqnames"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#### Add a non-standard column that I want to keep the casing for ####</span></span>
<span><span class="va">dat_raw</span><span class="op">$</span><span class="va">Support</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat_raw</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/standardise_header.html">standardise_header</a></span><span class="op">(</span>sumstats_dt <span class="op">=</span> <span class="va">dat_raw</span>,</span>
<span>                                          uppercase_unmapped <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                          return_list <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Standardising column headers.</span></span></code></pre>
<pre><code><span><span class="co">## First line of summary statistics file:</span></span></code></pre>
<pre><code><span><span class="co">## rsID Seqnames    BP  A1  A2  FRQ BETA    SE  P   Support </span></span></code></pre>
<pre><code><span><span class="co">## Returning unmapped column names without making them uppercase.</span></span></code></pre>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="16%">
<col width="5%">
<col width="13%">
<col width="4%">
<col width="4%">
<col width="11%">
<col width="10%">
<col width="8%">
<col width="8%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">SNP</th>
<th align="left">CHR</th>
<th align="right">BP</th>
<th align="left">A1</th>
<th align="left">A2</th>
<th align="right">FRQ</th>
<th align="right">BETA</th>
<th align="right">SE</th>
<th align="right">P</th>
<th align="right">Support</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">rs301800</td>
<td align="left">1</td>
<td align="right">8490603</td>
<td align="left">T</td>
<td align="left">C</td>
<td align="right">0.17910</td>
<td align="right">0.019</td>
<td align="right">0.003</td>
<td align="right">0e+00</td>
<td align="right">0.9805397</td>
</tr>
<tr class="even">
<td align="left">rs11210860</td>
<td align="left">1</td>
<td align="right">43982527</td>
<td align="left">A</td>
<td align="left">G</td>
<td align="right">0.36940</td>
<td align="right">0.017</td>
<td align="right">0.003</td>
<td align="right">0e+00</td>
<td align="right">0.7415215</td>
</tr>
<tr class="odd">
<td align="left">rs34305371</td>
<td align="left">1</td>
<td align="right">72733610</td>
<td align="left">A</td>
<td align="left">G</td>
<td align="right">0.08769</td>
<td align="right">0.035</td>
<td align="right">0.005</td>
<td align="right">0e+00</td>
<td align="right">0.0514463</td>
</tr>
<tr class="even">
<td align="left">rs2568955</td>
<td align="left">1</td>
<td align="right">72762169</td>
<td align="left">T</td>
<td align="left">C</td>
<td align="right">0.23690</td>
<td align="right">-0.017</td>
<td align="right">0.003</td>
<td align="right">0e+00</td>
<td align="right">0.5302125</td>
</tr>
<tr class="odd">
<td align="left">rs1008078</td>
<td align="left">1</td>
<td align="right">91189731</td>
<td align="left">T</td>
<td align="left">C</td>
<td align="right">0.37310</td>
<td align="right">-0.016</td>
<td align="right">0.003</td>
<td align="right">0e+00</td>
<td align="right">0.6958239</td>
</tr>
<tr class="even">
<td align="left">rs61787263</td>
<td align="left">1</td>
<td align="right">98618714</td>
<td align="left">T</td>
<td align="left">C</td>
<td align="right">0.76120</td>
<td align="right">0.016</td>
<td align="right">0.003</td>
<td align="right">1e-07</td>
<td align="right">0.6885560</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="future-enhancements">Future Enhancements<a class="anchor" aria-label="anchor" href="#future-enhancements"></a>
</h2>
<p>The <em>MungeSumstats</em> package aims to be able to handle the most
common summary statistic file formats including VCF. If your file can
not be formatted by <em>MungeSumstats</em> feel free to report the bug
on github: <a href="https://github.com/neurogenomics/MungeSumstats" class="external-link uri">https://github.com/neurogenomics/MungeSumstats</a> along
with your summary statistic file header.</p>
<p>We also encourage people to edit the code to resolve their particular
issues too and are happy to incorporate these through pull requests on
github. If your summary statistic file headers are not recognised by
<em>MungeSumstats</em> but correspond to one of:</p>
<pre><code>SNP, BP, CHR, A1, A2, P, Z, OR, BETA, LOG_ODDS,
SIGNED_SUMSTAT, N, N_CAS, N_CON, NSTUDY, INFO or FRQ </code></pre>
<p>feel free to update the
<code><a href="../reference/sumstatsColHeaders.html">MungeSumstats::sumstatsColHeaders</a></code> following the approach in
the data.R file and add your mapping. Then use a pull request on github
and we will incorporate this change into the package.</p>
<p>A note on <code><a href="../reference/sumstatsColHeaders.html">MungeSumstats::sumstatsColHeaders</a></code> for summary
statistic files with A0/A1. The mapping in
<code><a href="../reference/sumstatsColHeaders.html">MungeSumstats::sumstatsColHeaders</a></code> converts A0 to A*, this
is a special case so that the code knows to map A0/A1 to A1/A2
(ref/alt). The special case is needed since ordinarily A1 refers to the
reference not the alternative allele.</p>
<p>A note on <code><a href="../reference/sumstatsColHeaders.html">MungeSumstats::sumstatsColHeaders</a></code> for summary
statistic files with Effect Size (ES). By default, MSS takes BETA to be
any BETA-like value (including ES). This is coded into the mapping file
- <code><a href="../reference/sumstatsColHeaders.html">MungeSumstats::sumstatsColHeaders</a></code>. If this isn’t the case
for your sumstats, you can set the <code>es_is_beta</code> parameter in
<code><a href="../reference/format_sumstats.html">MungeSumstats::format_sumstats()</a></code> to FALSE to avoid this.
Note this is done to try and capture most use cases of MSS.</p>
</div>
<div class="section level2">
<h2 id="further-functionality">Further functionality<a class="anchor" aria-label="anchor" href="#further-functionality"></a>
</h2>
<p>See the <a href="https://neurogenomics.github.io/MungeSumstats/articles/OpenGWAS.html" class="external-link">Open
GWAS vignette</a> for how MungeSumstats can be used along with data from
the MRC IEU Open GWAS Project and also Mungesumstats’ functionality to
handle lists of summary statistics files.</p>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<details><pre><code><span><span class="co">## R version 4.3.0 (2023-04-21)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin20 (64-bit)</span></span>
<span><span class="co">## Running under: macOS 15.1.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/London</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] MungeSumstats_1.15.4 BiocStyle_2.30.0    </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] tidyselect_1.2.1                           </span></span>
<span><span class="co">##   [2] dplyr_1.1.4                                </span></span>
<span><span class="co">##   [3] blob_1.2.4                                 </span></span>
<span><span class="co">##   [4] filelock_1.0.3                             </span></span>
<span><span class="co">##   [5] R.utils_2.12.3                             </span></span>
<span><span class="co">##   [6] Biostrings_2.70.3                          </span></span>
<span><span class="co">##   [7] bitops_1.0-9                               </span></span>
<span><span class="co">##   [8] fastmap_1.2.0                              </span></span>
<span><span class="co">##   [9] RCurl_1.98-1.16                            </span></span>
<span><span class="co">##  [10] BiocFileCache_2.10.2                       </span></span>
<span><span class="co">##  [11] VariantAnnotation_1.48.1                   </span></span>
<span><span class="co">##  [12] GenomicAlignments_1.38.2                   </span></span>
<span><span class="co">##  [13] XML_3.99-0.17                              </span></span>
<span><span class="co">##  [14] digest_0.6.37                              </span></span>
<span><span class="co">##  [15] lifecycle_1.0.4                            </span></span>
<span><span class="co">##  [16] KEGGREST_1.42.0                            </span></span>
<span><span class="co">##  [17] RSQLite_2.3.7                              </span></span>
<span><span class="co">##  [18] magrittr_2.0.3                             </span></span>
<span><span class="co">##  [19] compiler_4.3.0                             </span></span>
<span><span class="co">##  [20] rlang_1.1.4                                </span></span>
<span><span class="co">##  [21] sass_0.4.9                                 </span></span>
<span><span class="co">##  [22] progress_1.2.3                             </span></span>
<span><span class="co">##  [23] tools_4.3.0                                </span></span>
<span><span class="co">##  [24] utf8_1.2.4                                 </span></span>
<span><span class="co">##  [25] yaml_2.3.10                                </span></span>
<span><span class="co">##  [26] data.table_1.16.0                          </span></span>
<span><span class="co">##  [27] rtracklayer_1.62.0                         </span></span>
<span><span class="co">##  [28] knitr_1.48                                 </span></span>
<span><span class="co">##  [29] prettyunits_1.2.0                          </span></span>
<span><span class="co">##  [30] S4Arrays_1.2.1                             </span></span>
<span><span class="co">##  [31] htmlwidgets_1.6.4                          </span></span>
<span><span class="co">##  [32] curl_5.2.3                                 </span></span>
<span><span class="co">##  [33] bit_4.5.0                                  </span></span>
<span><span class="co">##  [34] DelayedArray_0.28.0                        </span></span>
<span><span class="co">##  [35] ieugwasr_1.0.1                             </span></span>
<span><span class="co">##  [36] xml2_1.3.6                                 </span></span>
<span><span class="co">##  [37] abind_1.4-8                                </span></span>
<span><span class="co">##  [38] BiocParallel_1.36.0                        </span></span>
<span><span class="co">##  [39] purrr_1.0.2                                </span></span>
<span><span class="co">##  [40] BiocGenerics_0.48.1                        </span></span>
<span><span class="co">##  [41] desc_1.4.3                                 </span></span>
<span><span class="co">##  [42] R.oo_1.26.0                                </span></span>
<span><span class="co">##  [43] grid_4.3.0                                 </span></span>
<span><span class="co">##  [44] stats4_4.3.0                               </span></span>
<span><span class="co">##  [45] fansi_1.0.6                                </span></span>
<span><span class="co">##  [46] biomaRt_2.58.2                             </span></span>
<span><span class="co">##  [47] SummarizedExperiment_1.32.0                </span></span>
<span><span class="co">##  [48] cli_3.6.3                                  </span></span>
<span><span class="co">##  [49] rmarkdown_2.28                             </span></span>
<span><span class="co">##  [50] crayon_1.5.3                               </span></span>
<span><span class="co">##  [51] generics_0.1.3                             </span></span>
<span><span class="co">##  [52] ragg_1.3.1                                 </span></span>
<span><span class="co">##  [53] BSgenome.Hsapiens.1000genomes.hs37d5_0.99.1</span></span>
<span><span class="co">##  [54] rstudioapi_0.16.0                          </span></span>
<span><span class="co">##  [55] httr_1.4.7                                 </span></span>
<span><span class="co">##  [56] rjson_0.2.23                               </span></span>
<span><span class="co">##  [57] DBI_1.2.3                                  </span></span>
<span><span class="co">##  [58] cachem_1.1.0                               </span></span>
<span><span class="co">##  [59] stringr_1.5.1                              </span></span>
<span><span class="co">##  [60] zlibbioc_1.48.2                            </span></span>
<span><span class="co">##  [61] parallel_4.3.0                             </span></span>
<span><span class="co">##  [62] AnnotationDbi_1.64.1                       </span></span>
<span><span class="co">##  [63] BiocManager_1.30.25                        </span></span>
<span><span class="co">##  [64] XVector_0.42.0                             </span></span>
<span><span class="co">##  [65] restfulr_0.0.15                            </span></span>
<span><span class="co">##  [66] matrixStats_1.4.1                          </span></span>
<span><span class="co">##  [67] vctrs_0.6.5                                </span></span>
<span><span class="co">##  [68] Matrix_1.6-5                               </span></span>
<span><span class="co">##  [69] jsonlite_1.8.9                             </span></span>
<span><span class="co">##  [70] bookdown_0.39                              </span></span>
<span><span class="co">##  [71] IRanges_2.36.0                             </span></span>
<span><span class="co">##  [72] hms_1.1.3                                  </span></span>
<span><span class="co">##  [73] S4Vectors_0.40.2                           </span></span>
<span><span class="co">##  [74] bit64_4.5.2                                </span></span>
<span><span class="co">##  [75] GenomicFiles_1.38.0                        </span></span>
<span><span class="co">##  [76] systemfonts_1.0.6                          </span></span>
<span><span class="co">##  [77] GenomicFeatures_1.54.4                     </span></span>
<span><span class="co">##  [78] jquerylib_0.1.4                            </span></span>
<span><span class="co">##  [79] glue_1.8.0                                 </span></span>
<span><span class="co">##  [80] pkgdown_2.0.9                              </span></span>
<span><span class="co">##  [81] codetools_0.2-20                           </span></span>
<span><span class="co">##  [82] stringi_1.8.4                              </span></span>
<span><span class="co">##  [83] GenomeInfoDb_1.38.8                        </span></span>
<span><span class="co">##  [84] BiocIO_1.12.0                              </span></span>
<span><span class="co">##  [85] GenomicRanges_1.54.1                       </span></span>
<span><span class="co">##  [86] tibble_3.2.1                               </span></span>
<span><span class="co">##  [87] pillar_1.9.0                               </span></span>
<span><span class="co">##  [88] SNPlocs.Hsapiens.dbSNP155.GRCh37_0.99.24   </span></span>
<span><span class="co">##  [89] rappdirs_0.3.3                             </span></span>
<span><span class="co">##  [90] htmltools_0.5.8.1                          </span></span>
<span><span class="co">##  [91] GenomeInfoDbData_1.2.11                    </span></span>
<span><span class="co">##  [92] BSgenome_1.70.2                            </span></span>
<span><span class="co">##  [93] dbplyr_2.5.0                               </span></span>
<span><span class="co">##  [94] R6_2.5.1                                   </span></span>
<span><span class="co">##  [95] textshaping_0.3.7                          </span></span>
<span><span class="co">##  [96] evaluate_1.0.0                             </span></span>
<span><span class="co">##  [97] lattice_0.22-6                             </span></span>
<span><span class="co">##  [98] Biobase_2.62.0                             </span></span>
<span><span class="co">##  [99] R.methodsS3_1.8.2                          </span></span>
<span><span class="co">## [100] png_0.1-8                                  </span></span>
<span><span class="co">## [101] Rsamtools_2.18.0                           </span></span>
<span><span class="co">## [102] memoise_2.0.1                              </span></span>
<span><span class="co">## [103] bslib_0.8.0                                </span></span>
<span><span class="co">## [104] SparseArray_1.2.4                          </span></span>
<span><span class="co">## [105] xfun_0.48                                  </span></span>
<span><span class="co">## [106] fs_1.6.4                                   </span></span>
<span><span class="co">## [107] MatrixGenerics_1.14.0                      </span></span>
<span><span class="co">## [108] pkgconfig_2.0.3</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body" entry-spacing="0" line-spacing="2">
<div id="ref-Skene2018" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Nathan G. Skene, T. E. B., Julien Bryois.
Genetic identification of brain cell types underlying schizophrenia.
<em>Nature Genetics</em> (2018). doi:<a href="https://doi.org/10.1038/s41588-018-0129-5" class="external-link">10.1038/s41588-018-0129-5</a>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alan Murphy, Brian Schilder, Nathan Skene.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
