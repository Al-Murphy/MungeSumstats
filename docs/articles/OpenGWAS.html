<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Import GWAS summary statistics from Open GWAS • MungeSumstats</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Import GWAS summary statistics from Open GWAS">
<meta property="og:description" content="MungeSumstats">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-175929032-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-175929032-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MungeSumstats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.19</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MungeSumstats.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/OpenGWAS.html">Import GWAS summary statistics from Open GWAS</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/neurogenomics/MungeSumstats/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="OpenGWAS_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Import GWAS summary statistics from Open GWAS</h1>
                        <h4 class="author">Alan Murphy, Brian Schilder, and Nathan Skene</h4>
            
            <h4 class="date">2021-09-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/neurogenomics/MungeSumstats/blob/master/vignettes/OpenGWAS.Rmd"><code>vignettes/OpenGWAS.Rmd</code></a></small>
      <div class="hidden name"><code>OpenGWAS.Rmd</code></div>

    </div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/neurogenomics/MungeSumstats">MungeSumstats</a></span><span class="op">)</span></code></pre></div>
<p>MungeSumstats now offers high throughput query and import functionality to data from the MRC IEU <a href="https://gwas.mrcieu.ac.uk/">Open GWAS Project</a>.</p>
<div id="find-gwas-datasets" class="section level1">
<h1 class="hasAnchor">
<a href="#find-gwas-datasets" class="anchor"></a>Find GWAS datasets</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### Search for datasets ####</span>
<span class="va">metagwas</span> <span class="op">&lt;-</span> <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/find_sumstats.html">find_sumstats</a></span><span class="op">(</span>traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"parkinson"</span>,<span class="st">"alzheimer"</span><span class="op">)</span>, 
                                         min_sample_size <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">metagwas</span><span class="op">)</span></code></pre></div>
<pre><code>##                  id                                 trait group_name year
## 1:        ieu-a-298                   Alzheimer's disease     public 2013
## 2:          ieu-b-2                   Alzheimer's disease     public 2019
## 3:        ieu-a-297                   Alzheimer's disease     public 2013
## 4:        ieu-a-824                   Alzheimer's disease     public 2008
## 5: ebi-a-GCST002245      Alzheimer's disease (late onset)     public 2013
## 6: ebi-a-GCST005921 Family history of Alzheimer's disease     public 2018
##        author
## 1:    Lambert
## 2:  Kunkle BW
## 3:    Lambert
## 4:       Li H
## 5: Lambert JC
## 6: Marioni RE
##                                                                                                                                                                                                                                                                                                                     consortium
## 1:                                                                                                                                                                                                                                                                                                                        IGAP
## 2: Alzheimer Disease Genetics Consortium (ADGC), European Alzheimer's Disease Initiative (EADI), Cohorts for Heart and Aging Research in Genomic Epidemiology Consortium (CHARGE), Genetic and Environmental Risk in AD/Defining Genetic, Polygenic and Environmental Risk for Alzheimer's Disease Consortium (GERAD/PERADES),
## 3:                                                                                                                                                                                                                                                                                                                        IGAP
## 4:                                                                                                                                                                                                                                                                                                                          NA
## 5:                                                                                                                                                                                                                                                                                                                          NA
## 6:                                                                                                                                                                                                                                                                                                                          NA
##                  sex population     unit     nsnp sample_size       build
## 1: Males and Females   European log odds    11633       74046 HG19/GRCh37
## 2: Males and Females   European       NA 10528610       63926 HG19/GRCh37
## 3: Males and Females   European log odds  7055882       54162 HG19/GRCh37
## 4: Males and Females   European log odds   402973        1489 HG19/GRCh37
## 5:                NA   European    logOR  7022150       55134 HG19/GRCh37
## 6:                NA   European       NA  7746640      314278 HG19/GRCh37
##    category                subcategory ontology mr priority     pmid sd
## 1:  Disease Psychiatric / neurological       NA  1        1 24162737 NA
## 2:   Binary Psychiatric / neurological       NA  1        0 30820047 NA
## 3:  Disease Psychiatric / neurological       NA  1        2 24162737 NA
## 4:  Disease Psychiatric / neurological       NA  1        3 17998437 NA
## 5:       NA                         NA       NA  1        0 24162737 NA
## 6:       NA                         NA       NA  1        0 29777097 NA
##                                                                       note
## 1: Exposure only; Effect allele frequencies are missing; forward(+) strand
## 2:                                                                      NA
## 3:                Effect allele frequencies are missing; forward(+) strand
## 4:                                   Effect allele frequencies are missing
## 5:                                                                      NA
## 6:                                                                      NA
##    ncase ncontrol      N
## 1: 25580    48466  74046
## 2: 21982    41944  63926
## 3: 17008    37154  54162
## 4:   753      736   1489
## 5: 17008    37154  55134
## 6:    NA       NA 314278</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ids</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">metagwas</span>, <span class="va">nsnp</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">id</span>  </code></pre></div>
</div>
<div id="import-full-results" class="section level1">
<h1 class="hasAnchor">
<a href="#import-full-results" class="anchor"></a>Import full results</h1>
<p>You can supply <code><a href="../reference/import_sumstats.html">import_sumstats()</a></code> with a list of as many OpenGWAS IDs as you want, but we’ll just give one to save time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datasets</span> <span class="op">&lt;-</span> <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/import_sumstats.html">import_sumstats</a></span><span class="op">(</span>ids <span class="op">=</span> <span class="va">ids</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div id="summarise-results" class="section level2">
<h2 class="hasAnchor">
<a href="#summarise-results" class="anchor"></a>Summarise results</h2>
<p>By default, <code>import_sumstats</code> results a named list where the names are the Open GWAS dataset IDs and the items are the respective paths to the formatted summary statistics.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">datasets</span><span class="op">)</span></code></pre></div>
<pre><code>## $`ieu-a-298`
## [1] "/var/folders/hd/jm8lzp7s4dl_wlkykzhz66x80000gn/T//Rtmp7Nbilh/ieu-a-298.tsv.gz"</code></pre>
<p>You can easily turn this into a data.frame as well.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">datasets</span><span class="op">)</span>, 
                         path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">datasets</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results_df</span><span class="op">)</span></code></pre></div>
<pre><code>##                  id
## ieu-a-298 ieu-a-298
##                                                                                    path
## ieu-a-298 /var/folders/hd/jm8lzp7s4dl_wlkykzhz66x80000gn/T//Rtmp7Nbilh/ieu-a-298.tsv.gz</code></pre>
</div>
</div>
<div id="import-full-results-parallel" class="section level1">
<h1 class="hasAnchor">
<a href="#import-full-results-parallel" class="anchor"></a>Import full results (parallel)</h1>
<p><em>Optional</em>: Speed up with multi-threaded download via <a href="https://github.com/axel-download-accelerator/axel">axel</a>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datasets</span> <span class="op">&lt;-</span> <span class="fu">MungeSumstats</span><span class="fu">::</span><span class="fu"><a href="../reference/import_sumstats.html">import_sumstats</a></span><span class="op">(</span>ids <span class="op">=</span> <span class="va">ids</span>, 
                                           vcf_download <span class="op">=</span> <span class="cn">TRUE</span>, 
                                           download_method <span class="op">=</span> <span class="st">"axel"</span>, 
                                           nThread <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/re-exports.html">availableCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="further-functionality" class="section level1">
<h1 class="hasAnchor">
<a href="#further-functionality" class="anchor"></a>Further functionality</h1>
<p>See the <a href="https://neurogenomics.github.io/MungeSumstats/articles/MungeSumstats.html">Getting started vignette</a> for more information on how to use MungeSumstats and its functionality.</p>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<details><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.0 (2021-05-18)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_IE.UTF-8/en_IE.UTF-8/en_IE.UTF-8/C/en_IE.UTF-8/en_IE.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] MungeSumstats_1.1.19 BiocStyle_2.20.2    
## 
## loaded via a namespace (and not attached):
##   [1] bitops_1.0-7                               
##   [2] matrixStats_0.60.1                         
##   [3] fs_1.5.0                                   
##   [4] bit64_4.0.5                                
##   [5] filelock_1.0.2                             
##   [6] progress_1.2.2                             
##   [7] httr_1.4.2                                 
##   [8] googleAuthR_1.4.0                          
##   [9] rprojroot_2.0.2                            
##  [10] GenomeInfoDb_1.28.1                        
##  [11] tools_4.1.0                                
##  [12] bslib_0.2.5.1                              
##  [13] utf8_1.2.2                                 
##  [14] R6_2.5.1                                   
##  [15] DBI_1.1.1                                  
##  [16] BiocGenerics_0.38.0                        
##  [17] tidyselect_1.1.1                           
##  [18] prettyunits_1.1.1                          
##  [19] curl_4.3.2                                 
##  [20] bit_4.0.4                                  
##  [21] compiler_4.1.0                             
##  [22] cli_3.0.1                                  
##  [23] textshaping_0.3.5                          
##  [24] Biobase_2.52.0                             
##  [25] xml2_1.3.2                                 
##  [26] desc_1.3.0                                 
##  [27] DelayedArray_0.18.0                        
##  [28] rtracklayer_1.52.1                         
##  [29] bookdown_0.23                              
##  [30] sass_0.4.0                                 
##  [31] rappdirs_0.3.3                             
##  [32] pkgdown_1.6.1                              
##  [33] systemfonts_1.0.2                          
##  [34] stringr_1.4.0                              
##  [35] digest_0.6.27                              
##  [36] Rsamtools_2.8.0                            
##  [37] rmarkdown_2.10                             
##  [38] R.utils_2.10.1                             
##  [39] XVector_0.32.0                             
##  [40] BSgenome.Hsapiens.1000genomes.hs37d5_0.99.1
##  [41] pkgconfig_2.0.3                            
##  [42] htmltools_0.5.2                            
##  [43] MatrixGenerics_1.4.2                       
##  [44] dbplyr_2.1.1                               
##  [45] fastmap_1.1.0                              
##  [46] BSgenome_1.60.0                            
##  [47] rlang_0.4.11                               
##  [48] rstudioapi_0.13                            
##  [49] RSQLite_2.2.8                              
##  [50] jquerylib_0.1.4                            
##  [51] BiocIO_1.2.0                               
##  [52] generics_0.1.0                             
##  [53] jsonlite_1.7.2                             
##  [54] BiocParallel_1.26.2                        
##  [55] dplyr_1.0.7                                
##  [56] R.oo_1.24.0                                
##  [57] VariantAnnotation_1.38.0                   
##  [58] RCurl_1.98-1.4                             
##  [59] magrittr_2.0.1                             
##  [60] GenomeInfoDbData_1.2.6                     
##  [61] Matrix_1.3-4                               
##  [62] Rcpp_1.0.7                                 
##  [63] S4Vectors_0.30.0                           
##  [64] fansi_0.5.0                                
##  [65] lifecycle_1.0.0                            
##  [66] R.methodsS3_1.8.1                          
##  [67] stringi_1.7.4                              
##  [68] yaml_2.2.1                                 
##  [69] SummarizedExperiment_1.22.0                
##  [70] zlibbioc_1.38.0                            
##  [71] BiocFileCache_2.0.0                        
##  [72] grid_4.1.0                                 
##  [73] blob_1.2.2                                 
##  [74] parallel_4.1.0                             
##  [75] crayon_1.4.1                               
##  [76] lattice_0.20-44                            
##  [77] Biostrings_2.60.2                          
##  [78] GenomicFeatures_1.44.1                     
##  [79] hms_1.1.0                                  
##  [80] KEGGREST_1.32.0                            
##  [81] knitr_1.33                                 
##  [82] pillar_1.6.2                               
##  [83] GenomicRanges_1.44.0                       
##  [84] rjson_0.2.20                               
##  [85] BSgenome.Hsapiens.NCBI.GRCh38_1.3.1000     
##  [86] biomaRt_2.48.3                             
##  [87] stats4_4.1.0                               
##  [88] XML_3.99-0.7                               
##  [89] glue_1.4.2                                 
##  [90] evaluate_0.14                              
##  [91] SNPlocs.Hsapiens.dbSNP144.GRCh37_0.99.20   
##  [92] data.table_1.14.0                          
##  [93] BiocManager_1.30.16                        
##  [94] SNPlocs.Hsapiens.dbSNP144.GRCh38_0.99.20   
##  [95] png_0.1-7                                  
##  [96] vctrs_0.3.8                                
##  [97] purrr_0.3.4                                
##  [98] assertthat_0.2.1                           
##  [99] cachem_1.0.6                               
## [100] xfun_0.25                                  
## [101] restfulr_0.0.13                            
## [102] ragg_1.1.3                                 
## [103] gargle_1.2.0                               
## [104] tibble_3.1.4                               
## [105] GenomicAlignments_1.28.0                   
## [106] AnnotationDbi_1.54.1                       
## [107] memoise_2.0.0                              
## [108] IRanges_2.26.0                             
## [109] ellipsis_0.3.2</code></pre>
</details>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alan Murphy, Nathan Skene.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
