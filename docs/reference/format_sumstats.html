<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Check that summary statistics from GWAS are in a homogeneous format — format_sumstats • MungeSumstats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Check that summary statistics from GWAS are in a homogeneous format — format_sumstats"><meta property="og:description" content="Check that summary statistics from GWAS are in a homogeneous format"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MungeSumstats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/MungeSumstats.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/docker.html">Docker/Singularity Containers</a>
    </li>
    <li>
      <a href="../articles/OpenGWAS.html">Import GWAS summary statistics from Open GWAS</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/neurogenomics/MungeSumstats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Check that summary statistics from GWAS are in a homogeneous format</h1>
    <small class="dont-index">Source: <a href="https://github.com/neurogenomics/MungeSumstats/blob/HEAD/R/format_sumstats.R" class="external-link"><code>R/format_sumstats.R</code></a></small>
    <div class="hidden name"><code>format_sumstats.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Check that summary statistics from GWAS are in a homogeneous format</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">format_sumstats</span><span class="op">(</span></span>
<span>  <span class="va">path</span>,</span>
<span>  ref_genome <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  convert_ref_genome <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chain_source <span class="op">=</span> <span class="st">"ensembl"</span>,</span>
<span>  local_chain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  convert_small_p <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  convert_large_p <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  convert_neg_p <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  compute_z <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  force_new_z <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  compute_n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  convert_n_int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  impute_beta <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  es_is_beta <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  impute_se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  analysis_trait <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ignore_multi_trait <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  INFO_filter <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  FRQ_filter <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pos_se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  effect_columns_nonzero <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  N_std <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  N_dropNA <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chr_style <span class="op">=</span> <span class="st">"Ensembl"</span>,</span>
<span>  rmv_chr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"MT"</span><span class="op">)</span>,</span>
<span>  on_ref_genome <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  infer_eff_direction <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  eff_on_minor_alleles <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  strand_ambig_filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  allele_flip_check <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allele_flip_drop <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allele_flip_z <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allele_flip_frq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bi_allelic_filter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  flip_frq_as_biallelic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  snp_ids_are_rs_ids <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  remove_multi_rs_snp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  frq_is_maf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  indels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  drop_indels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_na_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNP"</span>, <span class="st">"CHR"</span>, <span class="st">"BP"</span>, <span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"FRQ"</span>, <span class="st">"BETA"</span>, <span class="st">"Z"</span>, <span class="st">"OR"</span>, <span class="st">"LOG_ODDS"</span>,</span>
<span>    <span class="st">"SIGNED_SUMSTAT"</span>, <span class="st">"SE"</span>, <span class="st">"P"</span>, <span class="st">"N"</span><span class="op">)</span>,</span>
<span>  dbSNP <span class="op">=</span> <span class="fl">155</span>,</span>
<span>  check_dups <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sort_coordinates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nThread <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  save_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".tsv.gz"</span><span class="op">)</span>,</span>
<span>  write_vcf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tabix_index <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_format <span class="op">=</span> <span class="st">"data.table"</span>,</span>
<span>  ldsc_format <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_format <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  log_folder_ind <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  log_mungesumstats_msgs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  log_folder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  imputation_ind <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  force_new <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mapping_file <span class="op">=</span> <span class="va">sumstatsColHeaders</span>,</span>
<span>  rmv_chrPrefix <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>path</dt>
<dd><p>Filepath for the summary statistics file to be formatted. A
dataframe or datatable of the summary statistics file can also be passed
directly to MungeSumstats using the path parameter.</p></dd>


<dt>ref_genome</dt>
<dd><p>name of the reference genome used for the GWAS ("GRCh37" or
"GRCh38"). Argument is case-insensitive. Default is NULL which infers the
reference genome from the data.</p></dd>


<dt>convert_ref_genome</dt>
<dd><p>name of the reference genome to convert to
("GRCh37" or "GRCh38"). This will only occur if the current genome build does
not match. Default is not to convert the genome build (NULL).</p></dd>


<dt>chain_source</dt>
<dd><p>source of the chain file to use in liftover, if converting
genome build ("ucsc" or "ensembl"). Note that the UCSC chain files require a
license for commercial use. The Ensembl chain is used by default ("ensembl").</p></dd>


<dt>local_chain</dt>
<dd><p>Path to local chain file to use instead of downlaoding.
Default of NULL i.e. no local file to use. NOTE if passing a local chain file
make sure to specify the path to convert from and to the correct build like
GRCh37 to GRCh38. We can not sense check this for local files. The chain file
can be submitted as a gz file (as downloaed from source) or unzipped.</p></dd>


<dt>convert_small_p</dt>
<dd><p>Binary, should non-negative
p-values &lt;= 5e-324 be converted to 0?
Small p-values pass the R limit and can cause errors with LDSC/MAGMA and
should be converted. Default is TRUE.</p></dd>


<dt>convert_large_p</dt>
<dd><p>Binary, should p-values &gt;1 be converted to 1?
P-values &gt;1 should not be possible and can cause errors with LDSC/MAGMA and
should be converted. Default is TRUE.</p></dd>


<dt>convert_neg_p</dt>
<dd><p>Binary, should p-values &lt;0 be converted to 0?
Negative p-values should not be possible and can cause errors
with LDSC/MAGMA and should be converted. Default is TRUE.</p></dd>


<dt>compute_z</dt>
<dd><p>Whether to compute Z-score column. Default is FALSE. This
can be computed from Beta and SE with (Beta/SE) or P
(Z:=sign(BETA)*sqrt(stats::qchisq(P,1,lower=FALSE))).
<strong>Note</strong> that imputing the Z-score from P for every SNP will not be
perfectly correct and may result in a loss of power. This should only be done
as a last resort. Use 'BETA' to impute by BETA/SE and 'P' to impute by SNP
p-value.</p></dd>


<dt>force_new_z</dt>
<dd><p>When a "Z" column already exists, it will be used by
default. To override and compute a new Z-score column from P set
<code>force_new_z=TRUE</code>.</p></dd>


<dt>compute_n</dt>
<dd><p>Whether to impute N. Default of 0 won't impute, any other
integer will be imputed as the N (sample size) for every SNP in the dataset.
<strong>Note</strong> that imputing the sample size for every SNP is not correct and
should only be done as a last resort. N can also be inputted with "ldsc",
"sum", "giant" or "metal" by passing one of these for this field or a vector
of multiple. Sum and an integer value creates an N column in the output
whereas giant, metal or ldsc create an Neff or effective sample size. If
multiples are passed, the formula used to derive it will be indicated.</p></dd>


<dt>convert_n_int</dt>
<dd><p>Binary, if N (the number of samples) is not an integer,
should this be rounded? Default is TRUE.</p></dd>


<dt>impute_beta</dt>
<dd><p>Binary, whether BETA should be imputed using other effect
data if it isn't present in the sumstats. Note that this imputation is an
approximation (for Z &amp; SE approach) so could have an effect on downstream
analysis. Use with caution. The different methods MungeSumstats will try and
impute beta (in this order or priority) are:</p><ol><li><p>log(OR)  2. Z x SE
Default value is FALSE.</p></li>
</ol></dd>


<dt>es_is_beta</dt>
<dd><p>Binary, whether to map ES to BETA. We take BETA to be any
BETA-like value (including Effect Size). If this is not the case for your
sumstats, change this to FALSE. Default is TRUE.</p></dd>


<dt>impute_se</dt>
<dd><p>Binary, whether the standard error should be imputed using
other effect data if it isn't present in the sumstats. Note that this
imputation is an approximation so could have an effect on downstream
analysis. Use with caution. The different methods MungeSumstats will try and
impute se (in this order or priority) are:</p><ol><li><p>BETA / Z  2. abs(BETA/ qnorm(P/2))
Default is FALSE.</p></li>
</ol></dd>


<dt>analysis_trait</dt>
<dd><p>If multiple traits were studied, name of the trait for
analysis from the GWAS. Default is NULL.</p></dd>


<dt>ignore_multi_trait</dt>
<dd><p>If you have multiple traits (p-values) in the study
but you want to ignorwe these and instead use a standard named p-value, set
to TRUE. By default is FALSE which will check for multi-traits.</p></dd>


<dt>INFO_filter</dt>
<dd><p>numeric The minimum value permissible of the imputation
information score (if present in sumstats file). Default 0.9.</p></dd>


<dt>FRQ_filter</dt>
<dd><p>numeric The minimum value permissible of the frequency(FRQ)
of the SNP (i.e. Allele Frequency (AF)) (if present in sumstats file). By
default no filtering is done, i.e. value of 0.</p></dd>


<dt>pos_se</dt>
<dd><p>Binary Should the standard Error (SE) column be checked to
ensure it is greater than 0? Those that are, are removed (if present in
sumstats file). Default TRUE.</p></dd>


<dt>effect_columns_nonzero</dt>
<dd><p>Binary should the effect columns in the data
BETA,OR (odds ratio),LOG_ODDS,SIGNED_SUMSTAT be checked to ensure no SNP=0.
Those that do are removed(if present in sumstats file). Default FALSE.</p></dd>


<dt>N_std</dt>
<dd><p>numeric The number of standard deviations above the mean a SNP's
N is needed to be removed. Default is 5.</p></dd>


<dt>N_dropNA</dt>
<dd><p>Drop rows where N is missing.Default is TRUE.</p></dd>


<dt>chr_style</dt>
<dd><p>Chromosome naming style to use in the formatted summary
statistics file ("NCBI", "UCSC", "dbSNP", or "Ensembl"). The NCBI and
Ensembl styles both code chromosomes as <code>1-22, X, Y, MT</code>; the UCSC style is
<code>chr1-chr22, chrX, chrY, chrM</code>; and the dbSNP style is
<code>ch1-ch22, chX, chY, chMT</code>. Default is Ensembl.</p></dd>


<dt>rmv_chr</dt>
<dd><p>Chromosomes to exclude from the formatted summary statistics
file. Use NULL if no filtering is necessary. Default is <code>c("X", "Y", "MT")</code>
which removes all non-autosomal SNPs.</p></dd>


<dt>on_ref_genome</dt>
<dd><p>Binary Should a check take place that all SNPs are on
the reference genome by SNP ID. Default is TRUE.</p></dd>


<dt>infer_eff_direction</dt>
<dd><p>Binary Should a check take place to ensure the
alleles match the effect direction? Default is TRUE.</p></dd>


<dt>eff_on_minor_alleles</dt>
<dd><p>Binary Should MungeSumstats assume that the
effects are majoritively measured on the minor alleles? Default is FALSE as
this is an assumption that won't be appropriate in all cases. However, the
benefit is that if we know the majority of SNPs have their effects based on
the minor alleles, we can catch cases where the allele columns have been
mislabelled.</p></dd>


<dt>strand_ambig_filter</dt>
<dd><p>Binary Should SNPs with strand-ambiguous alleles
be removed. Default is FALSE.</p></dd>


<dt>allele_flip_check</dt>
<dd><p>Binary Should the allele columns be checked against
reference genome to infer if flipping is necessary. Default is TRUE.</p></dd>


<dt>allele_flip_drop</dt>
<dd><p>Binary Should the SNPs for which neither their A1 or
A2 base pair values match a reference genome be dropped. Default is TRUE.</p></dd>


<dt>allele_flip_z</dt>
<dd><p>Binary should the Z-score be flipped along with effect
and FRQ columns like Beta? It is assumed to be calculated off the effect size
not the P-value and so will be flipped i.e. default TRUE.</p></dd>


<dt>allele_flip_frq</dt>
<dd><p>Binary should the frequency (FRQ) column be flipped
along with effect and z-score columns like Beta? Default TRUE.</p></dd>


<dt>bi_allelic_filter</dt>
<dd><p>Binary Should non-bi-allelic SNPs be removed.
Default is TRUE.</p></dd>


<dt>flip_frq_as_biallelic</dt>
<dd><p>Binary Should non-bi-allelic SNPs frequency
values be flipped as 1-p despite there being other alternative alleles?
Default is FALSE but if set to TRUE, this allows non-bi-allelic SNPs to be
kept despite needing flipping.</p></dd>


<dt>snp_ids_are_rs_ids</dt>
<dd><p>Binary Should the supplied SNP ID's be assumed to
be RSIDs. If not, imputation using the SNP ID for other columns like
base-pair position or chromosome will not be possible. If set to FALSE, the
SNP RS ID will be imputed from the reference genome if possible. Default is
TRUE.</p></dd>


<dt>remove_multi_rs_snp</dt>
<dd><p>Binary Sometimes summary statistics can have
multiple RSIDs on one row (i.e. related to one SNP), for example
"rs5772025_rs397784053". This can cause an error so by default, the first
RS ID will be kept and the rest removed e.g."rs5772025". If you want to just
remove these SNPs entirely, set it to TRUE. Default is FALSE.</p></dd>


<dt>frq_is_maf</dt>
<dd><p>Conventionally the FRQ column is intended to show the
minor/effect allele frequency (MAF) but sometimes the major allele frequency
can be inferred as the FRQ column. This logical variable indicates that the
FRQ column should be renamed to MAJOR_ALLELE_FRQ if the frequency values
appear to relate to the major allele i.e. &gt;0.5. By default this mapping won't
occur i.e. is TRUE.</p></dd>


<dt>indels</dt>
<dd><p>Binary does your Sumstats file contain Indels? These don't
exist in our reference file so they will be excluded from checks if this
value is TRUE. Default is TRUE.</p></dd>


<dt>drop_indels</dt>
<dd><p>Binary, should any indels found in the sumstats be
dropped? These can not be checked against a reference dataset and will have
the same RS ID and position as SNPs which can affect downstream analysis.
Default is False.</p></dd>


<dt>drop_na_cols</dt>
<dd><p>A character vector of column names to be checked for
missing values. Rows with missing values in any of these columns (if present
in the dataset) will be dropped. If <code>NULL</code>, all columns will be checked for
missing values. Default columns are SNP, chromosome, position, allele 1,
allele2, effect columns (frequency, beta, Z-score, standard error, log odds,
signed sumstats, odds ratio), p value and N columns.</p></dd>


<dt>dbSNP</dt>
<dd><p>version of dbSNP to be used for imputation (144 or 155).</p></dd>


<dt>check_dups</dt>
<dd><p>whether to check for duplicates - if formatting QTL
datasets this should be set to FALSE otherwise keep as TRUE. Default is TRUE.</p></dd>


<dt>sort_coordinates</dt>
<dd><p>Whether to sort by coordinates of resulting sumstats</p></dd>


<dt>nThread</dt>
<dd><p>Number of threads to use for parallel processes.</p></dd>


<dt>save_path</dt>
<dd><p>File path to save formatted data. Defaults to
<code>tempfile(fileext=".tsv.gz")</code>.</p></dd>


<dt>write_vcf</dt>
<dd><p>Whether to write as VCF (TRUE) or tabular file (FALSE).</p></dd>


<dt>tabix_index</dt>
<dd><p>Index the formatted summary statistics with
<a href="http://www.htslib.org/doc/tabix.html" class="external-link">tabix</a> for fast querying.</p></dd>


<dt>return_data</dt>
<dd><p>Return <code>data.table</code>, <code>GRanges</code> or <code>VRanges</code>
directly to user. Otherwise, return the path to the save data. Default is
FALSE.</p></dd>


<dt>return_format</dt>
<dd><p>If return_data is TRUE. Object type to be returned
("data.table","vranges","granges").</p></dd>


<dt>ldsc_format</dt>
<dd><p>DEPRECATED, do not use. Use save_format="LDSC" instead.</p></dd>


<dt>save_format</dt>
<dd><p>Output format of sumstats. Options are NULL - standardised
output format from MungeSumstats, LDSC - output format compatible with LDSC
and openGWAS - output compatible with openGWAS VCFs. Default is NULL.
<strong>NOTE</strong> - If LDSC format is used, the naming convention of A1 as the
reference (genome build) allele and A2 as the effect allele will be reversed
to match LDSC (A1 will now be the effect allele). See more info on this
<a href="https://groups.google.com/g/ldsc_users/c/S7FZK743w68" class="external-link">here</a>. Note that any
effect columns (e.g. Z) will be inrelation to A1 now instead of A2.</p></dd>


<dt>log_folder_ind</dt>
<dd><p>Binary Should log files be stored containing all
filtered out SNPs (separate file per filter). The data is outputted in the
same format specified for the resulting sumstats file. The only exception to
this rule is if output is vcf, then log file saved as .tsv.gz. Default is
FALSE.</p></dd>


<dt>log_mungesumstats_msgs</dt>
<dd><p>Binary Should a log be stored containing all
messages and errors printed by MungeSumstats in a run. Default is FALSE</p></dd>


<dt>log_folder</dt>
<dd><p>Filepath to the directory for the log files and the log of
MungeSumstats messages to be stored. Default is a temporary directory. Note
the name of the log files (log messages and log outputs) are now the same as
the name of the file specified in the save path parameter with the extension
'_log_msg.txt' and '_log_output.txt' respectively.</p></dd>


<dt>imputation_ind</dt>
<dd><p>Binary Should a column be added for each imputation
step to show what SNPs have imputed values for differing fields. This
includes a field denoting SNP allele flipping (flipped). On the flipped
value, this denoted whether the alelles where switched based on
MungeSumstats initial choice of A1, A2 from the input column headers and thus
may not align with what the creator intended.<strong>Note</strong> these columns will be
in the formatted summary statistics returned. Default is FALSE.</p></dd>


<dt>force_new</dt>
<dd><p>If a formatted file of the same names as <code>save_path</code>
exists, formatting will be skipped and this file will be imported instead
(default). Set <code>force_new=TRUE</code> to override this.</p></dd>


<dt>mapping_file</dt>
<dd><p>MungeSumstats has a pre-defined column-name mapping file
which should cover the most common column headers and their interpretations.
However, if a column header that is in youf file is missing of the mapping we
give is incorrect you can supply your own mapping file. Must be a 2 column
dataframe with column names "Uncorrected" and "Corrected". See
data(sumstatsColHeaders) for default mapping and necessary format.</p></dd>


<dt>rmv_chrPrefix</dt>
<dd><p>Is now deprecated, do. not use. Use chr_style instead -
chr_style = 'Ensembl' will give the same result as rmv_chrPrefix=TRUE used to
give.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The address for the modified sumstats file or the actual data
dependent on user choice. Also, if log files wanted by the user, the return
in both above instances are a list.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Pass path to Educational Attainment Okbay sumstat file to a temp directory</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">eduAttainOkbayPth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"eduAttainOkbay.txt"</span>,</span></span>
<span class="r-in"><span>    package <span class="op">=</span> <span class="st">"MungeSumstats"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Call uses reference genome as default with more than 2GB of memory,</span></span></span>
<span class="r-in"><span><span class="co">## which is more than what 32-bit Windows can handle so remove certain checks</span></span></span>
<span class="r-in"><span><span class="co">## Using dbSNP = 144 for speed as it's smaller but you should use 155 unless</span></span></span>
<span class="r-in"><span><span class="co">## you know what you are doing and need 144</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">is_32bit_windows</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"windows"</span> <span class="op">&amp;&amp;</span> <span class="va">.Platform</span><span class="op">$</span><span class="va">r_arch</span> <span class="op">==</span> <span class="st">"i386"</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">is_32bit_windows</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">reformatted</span> <span class="op">&lt;-</span> <span class="fu">format_sumstats</span><span class="op">(</span></span></span>
<span class="r-in"><span>        path <span class="op">=</span> <span class="va">eduAttainOkbayPth</span>,</span></span>
<span class="r-in"><span>        ref_genome <span class="op">=</span> <span class="st">"GRCh37"</span>,</span></span>
<span class="r-in"><span>        dbSNP <span class="op">=</span> <span class="fl">144</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">reformatted</span> <span class="op">&lt;-</span> <span class="fu">format_sumstats</span><span class="op">(</span></span></span>
<span class="r-in"><span>        path <span class="op">=</span> <span class="va">eduAttainOkbayPth</span>,</span></span>
<span class="r-in"><span>        ref_genome <span class="op">=</span> <span class="st">"GRCh37"</span>,</span></span>
<span class="r-in"><span>        on_ref_genome <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>        strand_ambig_filter <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>        bi_allelic_filter <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>        allele_flip_check <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>        dbSNP<span class="op">=</span><span class="fl">144</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ******::NOTE::******</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Formatted results will be saved to `tempdir()` by default.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - This means all formatted summary stats will be deleted upon ending the R session.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - To keep formatted summary stats, change `save_path`  ( e.g. `save_path=file.path('./formatted',basename(path))` ),   or make sure to copy files elsewhere after processing  ( e.g. `file.copy(save_path, './formatted/' )`.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  ******************** </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatted summary statistics will be saved to ==&gt;  /var/folders/hd/jm8lzp7s4dl_wlkykzhz66x80000gn/T//Rtmp4DII6I/filec16d74d43914.tsv.gz</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>replacing previous import ‘utils::findMatches’ by ‘S4Vectors::findMatches’ when loading ‘SNPlocs.Hsapiens.dbSNP144.GRCh37’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Importing tabular file: /private/var/folders/hd/jm8lzp7s4dl_wlkykzhz66x80000gn/T/RtmpKLvRpi/temp_libpath17f3d19176b21/MungeSumstats/extdata/eduAttainOkbay.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking for empty columns.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Infer Effect Column</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> First line of summary statistics file: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> MarkerName	CHR	POS	A1	A2	EAF	Beta	SE	Pval	</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Allele columns are ambiguous, attempting to infer direction</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Standardising column headers.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> First line of summary statistics file: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> MarkerName	CHR	POS	A1	A2	EAF	Beta	SE	Pval	</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading SNPlocs data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading reference genome data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Preprocessing RSIDs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Validating RSIDs of 93 SNPs using BSgenome::snpsById...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BSgenome::snpsById done in 25 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Effect/frq column(s) relate to A2 in the inputted sumstats</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Found direction from matching reference genome - NOTE this assumes non-effect allele will match the reference genome</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Standardising column headers.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> First line of summary statistics file: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> MarkerName	CHR	POS	A1	A2	EAF	Beta	SE	Pval	</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Summary statistics report:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - 93 rows</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - 93 unique variants</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - 70 genome-wide significant variants (P&lt;5e-8)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - 20 chromosomes</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking for multi-GWAS.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking for multiple RSIDs on one row.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking SNP RSIDs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking for merged allele column.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking A1 is uppercase</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking A2 is uppercase</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking for incorrect base-pair positions</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ensuring all SNPs are on the reference genome.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading SNPlocs data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading reference genome data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Preprocessing RSIDs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Validating RSIDs of 93 SNPs using BSgenome::snpsById...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BSgenome::snpsById done in 14 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking for correct direction of A1 (reference) and A2 (alternative allele).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> There are 46 SNPs where A1 doesn't match the reference genome.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> These will be flipped with their effect columns.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking for missing data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking for duplicate columns.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking for duplicate SNPs from SNP ID.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking for SNPs with duplicated base-pair positions.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO column not available. Skipping INFO score filtering step.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering SNPs, ensuring SE&gt;0.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ensuring all SNPs have N&lt;5 std dev above mean.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking for bi-allelic SNPs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 67 SNPs (72%) have FRQ values &gt; 0.5. Conventionally the FRQ column is intended to show the minor/effect allele frequency.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The FRQ column was mapped from one of the following from the inputted  summary statistics file:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> FRQ, EAF, FREQUENCY, FRQ_U, F_U, MAF, FREQ, FREQ_TESTED_ALLELE, FRQ_TESTED_ALLELE, FREQ_EFFECT_ALLELE, FRQ_EFFECT_ALLELE, EFFECT_ALLELE_FREQUENCY, EFFECT_ALLELE_FREQ, EFFECT_ALLELE_FRQ, A2FREQ, A2FRQ, ALLELE_FREQUENCY, ALLELE_FREQ, ALLELE_FRQ, AF, MINOR_AF, EFFECT_AF, A2_AF, EFF_AF, ALT_AF, ALTERNATIVE_AF, INC_AF, A_2_AF, TESTED_AF, ALLELEFREQ, ALT_FREQ, EAF_HRC, EFFECTALLELEFREQ, FREQ.B, FREQ_EUROPEAN_1000GENOMES, FREQ_HAPMAP, FREQ_TESTED_ALLELE_IN_HRS, FRQ_U_113154, FRQ_U_31358, FRQ_U_344901, FRQ_U_43456, POOLED_ALT_AF, AF_ALT, AF.ALT, AF-ALT, ALT.AF, ALT-AF, A2.AF, A2-AF, AF.EFF, AF_EFF, ALL_AF</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> As frq_is_maf=TRUE, the FRQ column will not be renamed. If the FRQ values were intended to represent major allele frequency,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> set frq_is_maf=FALSE to rename the column as MAJOR_ALLELE_FRQ and differentiate it from minor/effect allele frequency.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sorting coordinates with 'data.table'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing in tabular format ==&gt; /var/folders/hd/jm8lzp7s4dl_wlkykzhz66x80000gn/T//Rtmp4DII6I/filec16d74d43914.tsv.gz</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Summary statistics report:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - 93 rows (100% of original 93 rows)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - 93 unique variants</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - 70 genome-wide significant variants (P&lt;5e-8)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - 20 chromosomes</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done munging in 0.753 minutes.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Successfully finished preparing sumstats file, preview:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading header.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>           SNP   CHR       BP     A1     A2     FRQ   BETA    SE         P</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>        &lt;char&gt; &lt;int&gt;    &lt;int&gt; &lt;char&gt; &lt;char&gt;   &lt;num&gt;  &lt;num&gt; &lt;num&gt;     &lt;num&gt;</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1:   rs301800     1  8490603      T      C 0.17910  0.019 0.003 1.794e-08</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2: rs11210860     1 43982527      G      A 0.63060 -0.017 0.003 2.359e-10</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 3: rs34305371     1 72733610      G      A 0.91231 -0.035 0.005 3.762e-14</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 4:  rs2568955     1 72762169      T      C 0.23690 -0.017 0.003 1.797e-08</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Returning path to saved data.</span>
<span class="r-in"><span><span class="co"># returned location has the updated summary statistics file</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alan Murphy, Brian Schilder, Nathan Skene.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

